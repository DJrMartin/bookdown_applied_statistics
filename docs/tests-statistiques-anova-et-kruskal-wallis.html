<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Tests statistiques (ANOVA et Kruskal Wallis) | Statistique appliquée aux sciences de l’environnement et du vivant</title>
  <meta name="description" content="Ce livre est à destination des étudiants qui veulent approfondir leur connaissance en statistique appliquée aux sciences du vivant." />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Tests statistiques (ANOVA et Kruskal Wallis) | Statistique appliquée aux sciences de l’environnement et du vivant" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Ce livre est à destination des étudiants qui veulent approfondir leur connaissance en statistique appliquée aux sciences du vivant." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Tests statistiques (ANOVA et Kruskal Wallis) | Statistique appliquée aux sciences de l’environnement et du vivant" />
  
  <meta name="twitter:description" content="Ce livre est à destination des étudiants qui veulent approfondir leur connaissance en statistique appliquée aux sciences du vivant." />
  

<meta name="author" content="David M. Carminati" />


<meta name="date" content="2025-09-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tests-statistiques-t.-test-et-t.-wilcoxon.html"/>
<link rel="next" href="tests-statistiques-corrélations.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistiques appliquées aux sciences du vivant</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Statistique appliquée aux sciences de l’environnement et du vivant.</a></li>
<li class="chapter" data-level="1" data-path="introduction-au-langage-de-programmation-r.html"><a href="introduction-au-langage-de-programmation-r.html"><i class="fa fa-check"></i><b>1</b> Introduction au langage de programmation <code>R</code></a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-au-langage-de-programmation-r.html"><a href="introduction-au-langage-de-programmation-r.html#rstudio-et-ide."><i class="fa fa-check"></i><b>1.1</b> Rstudio et IDE.</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-au-langage-de-programmation-r.html"><a href="introduction-au-langage-de-programmation-r.html#les-pré-requis"><i class="fa fa-check"></i><b>1.2</b> Les pré-requis</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introduction-au-langage-de-programmation-r.html"><a href="introduction-au-langage-de-programmation-r.html#les-objects"><i class="fa fa-check"></i><b>1.2.1</b> Les objects</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction-au-langage-de-programmation-r.html"><a href="introduction-au-langage-de-programmation-r.html#les-fonctions"><i class="fa fa-check"></i><b>1.2.2</b> Les fonctions</a></li>
<li class="chapter" data-level="1.2.3" data-path="introduction-au-langage-de-programmation-r.html"><a href="introduction-au-langage-de-programmation-r.html#les-data-frames"><i class="fa fa-check"></i><b>1.2.3</b> Les data-frames</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction-au-langage-de-programmation-r.html"><a href="introduction-au-langage-de-programmation-r.html#les-boucles"><i class="fa fa-check"></i><b>1.3</b> Les boucles</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-au-langage-de-programmation-r.html"><a href="introduction-au-langage-de-programmation-r.html#les-fonctions-version-intermédiaire"><i class="fa fa-check"></i><b>1.4</b> Les fonctions (version intermédiaire)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html"><i class="fa fa-check"></i><b>2</b> Test statistique (<span class="math inline">\(\chi^2\)</span>)</a>
<ul>
<li class="chapter" data-level="2.1" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#observationexpériencecausalité-quelques-mots-de-vocabulaire"><i class="fa fa-check"></i><b>2.1</b> Observation/Expérience/causalité (quelques mots de vocabulaire)</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#échantillonspopulations"><i class="fa fa-check"></i><b>2.1.1</b> Échantillons/populations</a></li>
<li class="chapter" data-level="2.1.2" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#donnéesindividuvariables"><i class="fa fa-check"></i><b>2.1.2</b> Données/individu/variables</a></li>
<li class="chapter" data-level="2.1.3" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#méthodologie-danalyse"><i class="fa fa-check"></i><b>2.1.3</b> Méthodologie d’analyse</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#test-statistique-avec-2-variables-qualitatives."><i class="fa fa-check"></i><b>2.2</b> Test statistique avec 2 variables qualitatives.</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#statistiques-descriptives-et-visualisations"><i class="fa fa-check"></i><b>2.2.1</b> Statistiques descriptives et visualisations</a></li>
<li class="chapter" data-level="2.2.2" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#explication-des-tests-statistiques"><i class="fa fa-check"></i><b>2.2.2</b> Explication des Tests Statistiques</a></li>
<li class="chapter" data-level="2.2.3" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#test-statistique-pour-variables-qualitatives-chi2"><i class="fa fa-check"></i><b>2.2.3</b> Test Statistique pour variables qualitatives (<span class="math inline">\(\chi^2\)</span>)</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#révisions"><i class="fa fa-check"></i><b>2.3</b> Révisions</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#qcm"><i class="fa fa-check"></i><b>2.3.1</b> QCM</a></li>
<li class="chapter" data-level="2.3.2" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#questions-ouvertes-définitions"><i class="fa fa-check"></i><b>2.3.2</b> Questions ouvertes (définitions)</a></li>
<li class="chapter" data-level="2.3.3" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#problème"><i class="fa fa-check"></i><b>2.3.3</b> Problème</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#travaux-pratiques"><i class="fa fa-check"></i><b>2.4</b> Travaux Pratiques</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#pokemons"><i class="fa fa-check"></i><b>2.4.1</b> Pokemons</a></li>
<li class="chapter" data-level="2.4.2" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#travaux-pratiques-1"><i class="fa fa-check"></i><b>2.4.2</b> Travaux Pratiques</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tests-statistiques-t.-test-et-t.-wilcoxon.html"><a href="tests-statistiques-t.-test-et-t.-wilcoxon.html"><i class="fa fa-check"></i><b>3</b> Tests statistiques (t. test et t. wilcoxon)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tests-statistiques-t.-test-et-t.-wilcoxon.html"><a href="tests-statistiques-t.-test-et-t.-wilcoxon.html#statistiques-descriptives-et-visualisations-1"><i class="fa fa-check"></i><b>3.1</b> Statistiques descriptives et visualisations</a></li>
<li class="chapter" data-level="3.2" data-path="tests-statistiques-t.-test-et-t.-wilcoxon.html"><a href="tests-statistiques-t.-test-et-t.-wilcoxon.html#test-statistique-pour-variables-quantitatives-paramétriques-non-paramétriques"><i class="fa fa-check"></i><b>3.2</b> Test Statistique pour variables quantitatives (Paramétriques / Non paramétriques)</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="tests-statistiques-t.-test-et-t.-wilcoxon.html"><a href="tests-statistiques-t.-test-et-t.-wilcoxon.html#généralités-1"><i class="fa fa-check"></i><b>3.2.1</b> Généralités</a></li>
<li class="chapter" data-level="3.2.2" data-path="tests-statistiques-t.-test-et-t.-wilcoxon.html"><a href="tests-statistiques-t.-test-et-t.-wilcoxon.html#prérequis-pour-le-choix-du-test"><i class="fa fa-check"></i><b>3.2.2</b> Prérequis pour le choix du test</a></li>
<li class="chapter" data-level="3.2.3" data-path="tests-statistiques-t.-test-et-t.-wilcoxon.html"><a href="tests-statistiques-t.-test-et-t.-wilcoxon.html#test-paramétrique-test-de-student"><i class="fa fa-check"></i><b>3.2.3</b> Test paramétrique (test de Student)</a></li>
<li class="chapter" data-level="3.2.4" data-path="tests-statistiques-t.-test-et-t.-wilcoxon.html"><a href="tests-statistiques-t.-test-et-t.-wilcoxon.html#test-non-paramétrique-test-de-wilcoxon-mann-whitney"><i class="fa fa-check"></i><b>3.2.4</b> Test non paramétrique (test de Wilcoxon-Mann-Whitney)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="tests-statistiques-t.-test-et-t.-wilcoxon.html"><a href="tests-statistiques-t.-test-et-t.-wilcoxon.html#révisions-1"><i class="fa fa-check"></i><b>3.3</b> Révisions</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="tests-statistiques-t.-test-et-t.-wilcoxon.html"><a href="tests-statistiques-t.-test-et-t.-wilcoxon.html#rappel"><i class="fa fa-check"></i><b>3.3.1</b> Rappel</a></li>
<li class="chapter" data-level="3.3.2" data-path="tests-statistiques-t.-test-et-t.-wilcoxon.html"><a href="tests-statistiques-t.-test-et-t.-wilcoxon.html#qcm-1"><i class="fa fa-check"></i><b>3.3.2</b> QCM</a></li>
<li class="chapter" data-level="3.3.3" data-path="tests-statistiques-t.-test-et-t.-wilcoxon.html"><a href="tests-statistiques-t.-test-et-t.-wilcoxon.html#questions-ouvertes-définitions-1"><i class="fa fa-check"></i><b>3.3.3</b> Questions ouvertes (définitions)</a></li>
<li class="chapter" data-level="3.3.4" data-path="tests-statistiques-t.-test-et-t.-wilcoxon.html"><a href="tests-statistiques-t.-test-et-t.-wilcoxon.html#exercices-1"><i class="fa fa-check"></i><b>3.3.4</b> Exercices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html"><i class="fa fa-check"></i><b>4</b> Tests statistiques (ANOVA et Kruskal Wallis)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#tests-statistiques-pour-plusieurs-groupes"><i class="fa fa-check"></i><b>4.1</b> Tests statistiques pour plusieurs groupes</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#test-non-paramétrique-kruskall-wallis"><i class="fa fa-check"></i><b>4.1.1</b> Test non paramétrique (<strong>Kruskall-Wallis</strong>)</a></li>
<li class="chapter" data-level="4.1.2" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#test-paramétrique-anova"><i class="fa fa-check"></i><b>4.1.2</b> Test paramétrique (<strong>ANOVA</strong>)</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#tests-statistiques-multiples."><i class="fa fa-check"></i><b>4.2</b> Tests statistiques Multiples.</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#généralités-2"><i class="fa fa-check"></i><b>4.2.1</b> Généralités</a></li>
<li class="chapter" data-level="4.2.2" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#applications"><i class="fa fa-check"></i><b>4.2.2</b> Applications</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#révisions-2"><i class="fa fa-check"></i><b>4.3</b> Révisions</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#qcm-2"><i class="fa fa-check"></i><b>4.3.1</b> QCM</a></li>
<li class="chapter" data-level="4.3.2" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#questions-ouvertes-définitions-2"><i class="fa fa-check"></i><b>4.3.2</b> Questions ouvertes (définitions)</a></li>
<li class="chapter" data-level="4.3.3" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#problème-1"><i class="fa fa-check"></i><b>4.3.3</b> Problème</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#travaux-pratiques-2"><i class="fa fa-check"></i><b>4.4</b> Travaux pratiques</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#statistiques-descriptives-du-metabolisme-du-fer"><i class="fa fa-check"></i><b>4.4.1</b> Statistiques descriptives du metabolisme du fer</a></li>
<li class="chapter" data-level="4.4.2" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#tests-statistiques"><i class="fa fa-check"></i><b>4.4.2</b> Tests Statistiques</a></li>
<li class="chapter" data-level="4.4.3" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#modelisation-à-2-facteurs"><i class="fa fa-check"></i><b>4.4.3</b> Modelisation à 2 facteurs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="tests-statistiques-corrélations.html"><a href="tests-statistiques-corrélations.html"><i class="fa fa-check"></i><b>5</b> Tests statistiques (Corrélations)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="tests-statistiques-corrélations.html"><a href="tests-statistiques-corrélations.html#tests-dindépendance-entre-2-variables-quantitatives."><i class="fa fa-check"></i><b>5.1</b> Tests d’indépendance entre 2 variables <strong>quantitatives</strong>.</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="tests-statistiques-corrélations.html"><a href="tests-statistiques-corrélations.html#généralités-3"><i class="fa fa-check"></i><b>5.1.1</b> Généralités</a></li>
<li class="chapter" data-level="5.1.2" data-path="tests-statistiques-corrélations.html"><a href="tests-statistiques-corrélations.html#conditions"><i class="fa fa-check"></i><b>5.1.2</b> Conditions</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="tests-statistiques-corrélations.html"><a href="tests-statistiques-corrélations.html#paramètres-des-tests-de-correlation-exemple-avec-la-méthode-de-pearson"><i class="fa fa-check"></i><b>5.2</b> Paramètres des tests de correlation : Exemple avec la méthode de Pearson</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="tests-statistiques-corrélations.html"><a href="tests-statistiques-corrélations.html#premier-paramètre-a-coefficient-linéaire"><i class="fa fa-check"></i><b>5.2.1</b> Premier paramètre : <span class="math inline">\(a\)</span>, coefficient linéaire</a></li>
<li class="chapter" data-level="5.2.2" data-path="tests-statistiques-corrélations.html"><a href="tests-statistiques-corrélations.html#second-paramètre-r"><i class="fa fa-check"></i><b>5.2.2</b> Second paramètre : <span class="math inline">\(r\)</span></a></li>
<li class="chapter" data-level="5.2.3" data-path="tests-statistiques-corrélations.html"><a href="tests-statistiques-corrélations.html#troisième-paramètre-r2"><i class="fa fa-check"></i><b>5.2.3</b> troisième paramètre : <span class="math inline">\(r^2\)</span></a></li>
<li class="chapter" data-level="5.2.4" data-path="tests-statistiques-corrélations.html"><a href="tests-statistiques-corrélations.html#quatrième-paramètre-p-value"><i class="fa fa-check"></i><b>5.2.4</b> quatrième paramètre : <span class="math inline">\(p value\)</span></a></li>
<li class="chapter" data-level="5.2.5" data-path="tests-statistiques-corrélations.html"><a href="tests-statistiques-corrélations.html#code-r"><i class="fa fa-check"></i><b>5.2.5</b> Code R</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="tests-statistiques-corrélations.html"><a href="tests-statistiques-corrélations.html#test-de-spearman"><i class="fa fa-check"></i><b>5.3</b> Test de Spearman</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>6</b> Clustering</a>
<ul>
<li class="chapter" data-level="6.1" data-path="clustering.html"><a href="clustering.html#généralités-4"><i class="fa fa-check"></i><b>6.1</b> Généralités</a></li>
<li class="chapter" data-level="6.2" data-path="clustering.html"><a href="clustering.html#k-means-ou-algorithme-des-centres-mobiles-en-français"><i class="fa fa-check"></i><b>6.2</b> K-means (ou algorithme des centres mobiles en français)</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="clustering.html"><a href="clustering.html#principe"><i class="fa fa-check"></i><b>6.2.1</b> Principe</a></li>
<li class="chapter" data-level="6.2.2" data-path="clustering.html"><a href="clustering.html#algorithme-du-k-means-appartenance-à-une-classe-pour-chaque-individu"><i class="fa fa-check"></i><b>6.2.2</b> Algorithme du k-means (appartenance à une classe pour chaque individu)</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="clustering.html"><a href="clustering.html#classification-hiérarchique-ascendante"><i class="fa fa-check"></i><b>6.3</b> Classification Hiérarchique Ascendante</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="clustering.html"><a href="clustering.html#mesure-déloignement-entre-les-individus"><i class="fa fa-check"></i><b>6.3.1</b> Mesure d’éloignement entre les individus</a></li>
<li class="chapter" data-level="6.3.2" data-path="clustering.html"><a href="clustering.html#mesure-dagrégation"><i class="fa fa-check"></i><b>6.3.2</b> Mesure d’agrégation</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="clustering.html"><a href="clustering.html#définir-le-nombre-de-classes-optimales"><i class="fa fa-check"></i><b>6.4</b> Définir le nombre de classes optimales ?</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="clustering.html"><a href="clustering.html#première-approche-variance-totale-et-règle-du-coude"><i class="fa fa-check"></i><b>6.4.1</b> Première approche : Variance totale et règle du coude</a></li>
<li class="chapter" data-level="6.4.2" data-path="clustering.html"><a href="clustering.html#seconde-approche-coefficient-de-silhouette."><i class="fa fa-check"></i><b>6.4.2</b> Seconde approche : coefficient de Silhouette.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="clustering.html"><a href="clustering.html#travaux-pratiques-3"><i class="fa fa-check"></i><b>6.5</b> Travaux pratiques</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="clustering.html"><a href="clustering.html#création-de-votre-propre-algorithme"><i class="fa fa-check"></i><b>6.5.1</b> Création de votre propre algorithme</a></li>
<li class="chapter" data-level="6.5.2" data-path="clustering.html"><a href="clustering.html#efficacité-et-comparaison-de-lalgorithme"><i class="fa fa-check"></i><b>6.5.2</b> Efficacité et comparaison de l’algorithme</a></li>
<li class="chapter" data-level="6.5.3" data-path="clustering.html"><a href="clustering.html#clustering-1"><i class="fa fa-check"></i><b>6.5.3</b> Clustering</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html"><i class="fa fa-check"></i><b>7</b> Analyse en Composantes Principales</a>
<ul>
<li class="chapter" data-level="7.1" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#généralités-5"><i class="fa fa-check"></i><b>7.1</b> Généralités</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#etude-des-variables"><i class="fa fa-check"></i><b>7.1.1</b> Etude des variables</a></li>
<li class="chapter" data-level="7.1.2" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#normalisation-des-individus-pré-requis"><i class="fa fa-check"></i><b>7.1.2</b> Normalisation des individus : pré-requis</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#réaliser-la-pca-sur-r."><i class="fa fa-check"></i><b>7.2</b> Réaliser la PCA sur R.</a></li>
<li class="chapter" data-level="7.3" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#interprétation"><i class="fa fa-check"></i><b>7.3</b> Interprétation</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#graphique-des-individus"><i class="fa fa-check"></i><b>7.3.1</b> Graphique des individus</a></li>
<li class="chapter" data-level="7.3.2" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#graphique-des-variables-cercle-de-correlation-des-variables"><i class="fa fa-check"></i><b>7.3.2</b> Graphique des variables (cercle de correlation des variables)</a></li>
<li class="chapter" data-level="7.3.3" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#compréhension-des-axes"><i class="fa fa-check"></i><b>7.3.3</b> Compréhension des axes</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#travaux-pratiques-4"><i class="fa fa-check"></i><b>7.4</b> Travaux pratiques</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#préparation-des-données"><i class="fa fa-check"></i><b>7.4.1</b> Préparation des données</a></li>
<li class="chapter" data-level="7.4.2" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#analyse-en-composantes-principales-1"><i class="fa fa-check"></i><b>7.4.2</b> Analyse en composantes principales</a></li>
<li class="chapter" data-level="7.4.3" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#interprétation-des-axes"><i class="fa fa-check"></i><b>7.4.3</b> Interprétation des axes</a></li>
<li class="chapter" data-level="7.4.4" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#interprétation-des-individus"><i class="fa fa-check"></i><b>7.4.4</b> Interprétation des individus</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistique appliquée aux sciences de l’environnement et du vivant</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tests-statistiques-anova-et-kruskal-wallis" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Tests statistiques (ANOVA et Kruskal Wallis)<a href="tests-statistiques-anova-et-kruskal-wallis.html#tests-statistiques-anova-et-kruskal-wallis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="tests-statistiques-pour-plusieurs-groupes" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Tests statistiques pour plusieurs groupes<a href="tests-statistiques-anova-et-kruskal-wallis.html#tests-statistiques-pour-plusieurs-groupes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Pour ce cours nous prendrons un autre exemple concernant le potentiel de stockage du carbon au niveau du <strong>sol</strong> en fonction des types de climats/territoire. Ce travail a fait l’objet d’une publication scientifique dans le Journal <em>PNAS</em>. Vous pouvez lire le papier <a href="https://www.pnas.org/doi/10.1073/pnas.2111312119"><strong>ici</strong></a>.</p>
<p>Les données peuvent être téléchargées <a href="https://github.com/DJrMartin/bookdown_applied_statistics/blob/main/data/Carbon-Storage.rda"><strong>ici</strong></a>.</p>
<p>Importer les données avec le code suivant :</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb94-1" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file=</span><span class="st">&quot;data/Carbon-Storage.rda&quot;</span>)</span>
<span id="cb94-2"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb94-2" tabindex="-1"></a><span class="fu">colnames</span>(Carbon_storage)</span></code></pre></div>
<pre><code>## [1] &quot;Biome&quot;     &quot;Type&quot;      &quot;Current&quot;   &quot;Potential&quot;</code></pre>
<p>La matrice présente quatre variables, une variable sur le type de climat/biome sur lequel a été évalué le stockage de carbon, la seconde variable correspond au type de terrain où a été réalisé le prélévement (par exemple, forêt ou terrain agricôle). Enfin, la troisième variable correspond au stockage de carbon actuel et la dernière variable concerne le stockage potential. La somme des deux dernières colonnes correspond donc à la capacité du biome à stocker du carbon.</p>
<p>Dans les démonstrations qui vont suivre, nous nous intéresserons uniquement à la capacité actuelle et au trois biomes suivant : “Subtropical”, “Temperate” et “Boreal”.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Sélectionner ces trois types de biome et la variable “Current”. Enregister le tout dans un nouvel objet.</p></li>
<li><p>Représenter la capacité actuelle en fonction des 3 biomes.</p></li>
</ol>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb96-1" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">which</span>(Carbon_storage<span class="sc">$</span>Biome<span class="sc">==</span><span class="st">&quot;Subtropical&quot;</span><span class="sc">|</span>Carbon_storage<span class="sc">$</span>Biome<span class="sc">==</span><span class="st">&quot;Polar&quot;</span><span class="sc">|</span>Carbon_storage<span class="sc">$</span>Biome<span class="sc">==</span><span class="st">&quot;Boreal&quot;</span>)</span>
<span id="cb96-2"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb96-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;Biome&quot;</span><span class="ot">=</span> Carbon_storage<span class="sc">$</span>Biome,<span class="st">&quot;Current&quot;</span><span class="ot">=</span>Carbon_storage<span class="sc">$</span>Current)[w,]</span>
<span id="cb96-3"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb96-3" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">droplevels.data.frame</span>(df)</span>
<span id="cb96-4"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb96-4" tabindex="-1"></a><span class="fu">boxplot</span>(Current<span class="sc">~</span>Biome, df, <span class="at">outline=</span>F, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;tomato&quot;</span>, <span class="st">&quot;gold&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-49"></span>
<img src="Applied-statistics_files/figure-html/unnamed-chunk-49-1.png" alt="Figure 1 : Représentation du potentiel de stockage en fonction des biomes." width="576" />
<p class="caption">
Figure 4.1: Figure 1 : Représentation du potentiel de stockage en fonction des biomes.
</p>
</div>
<p>La question de recherche est maintenant de savoir s’il y a une différence dans le stockage de carbon (mesuré en 2022) entre ces trois biomes.</p>
<blockquote>
<p>De la même manière que les tests statistiques que nous avons vu dans les cours 2 et 3, nous devons verifier en amont si la variable pour chacun des groupes respecte la normalité et une variance égale.</p>
</blockquote>
<ol start="3" style="list-style-type: lower-alpha">
<li>À l’aide de la fonction shapiro.wilk() et bartlett.test(), vérifier la normalité de la variable dans les trois biomes et si leurs variances sont proches.</li>
</ol>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb97-1" tabindex="-1"></a><span class="cf">for</span>(biome <span class="cf">in</span> <span class="fu">unique</span>(df<span class="sc">$</span>Biome)){</span>
<span id="cb97-2"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb97-2" tabindex="-1"></a>  SW <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(df<span class="sc">$</span>Current[<span class="fu">which</span>(df<span class="sc">$</span>Biome<span class="sc">==</span>biome)])</span>
<span id="cb97-3"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb97-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Le test de Shapiro.Wilk renvoie une statistique de&quot;</span>, <span class="fu">round</span>(SW<span class="sc">$</span>statistic, <span class="dv">2</span>), <span class="st">&quot;et un p value associée de&quot;</span>, SW<span class="sc">$</span>p.value, <span class="st">&quot;pour le biome suivant&quot;</span>, biome))</span>
<span id="cb97-4"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb97-4" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Le test de Shapiro.Wilk renvoie une statistique de 0.26 et un p value associée de 1.41832946008063e-44 pour le biome suivant Subtropical&quot;
## [1] &quot;Le test de Shapiro.Wilk renvoie une statistique de 0.1 et un p value associée de 6.05259801465719e-26 pour le biome suivant Boreal&quot;
## [1] &quot;Le test de Shapiro.Wilk renvoie une statistique de 0.25 et un p value associée de 7.58129235692607e-14 pour le biome suivant Polar&quot;</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li>Que conclure sur la normalité de la variable en fonction des groupes ?</li>
</ol>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb99-1" tabindex="-1"></a><span class="fu">bartlett.test</span>(Current<span class="sc">~</span>Biome, df)</span></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  Current by Biome
## Bartlett&#39;s K-squared = 3028.6, df = 2, p-value &lt; 2.2e-16</code></pre>
<ol start="5" style="list-style-type: lower-alpha">
<li><p>Que conclure sur l’égalité des variance de la variable entre les groupes ?</p></li>
<li><p>Vers quelle famille de test statistique allez-nous nous tourner pour répondre à notre question biologique ?</p></li>
</ol>
<div id="test-non-paramétrique-kruskall-wallis" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Test non paramétrique (<strong>Kruskall-Wallis</strong>)<a href="tests-statistiques-anova-et-kruskal-wallis.html#test-non-paramétrique-kruskall-wallis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Le test de Kruskall-Wallis permet de comparer la position de 3 échantillons ou plus, <span class="math inline">\(x_1 = \{x_{11},··· ,x_{1n_1}\} , ···, x_k = \{x_{k1},··· ,x_{kn_k}\}\)</span>.</p>
<p><span class="math inline">\(H_0 : \hat{\theta}_1 =\hat{\theta}_2=\hat{\theta}_k\)</span> contre au moins une des <span class="math inline">\(\theta\)</span> est différent des autres (<span class="math inline">\(H_1\)</span>). Pour rappel <span class="math inline">\(\theta\)</span> est un paramètre, ici la distribution d’une variable pour un groupe <span class="math inline">\(k\)</span>.</p>
<blockquote>
<p>Le test de Kruskall-Wallis fait une analyse de la variance non paramétrique. On l’utilise pour les petits échantillons ou quand l’hypothèse de normalité n’est pas vérifiée.</p>
</blockquote>
<p>La statistique de test est donnée par :</p>
<p><span class="math display">\[S_{KW}=  \frac{12}{n(n+1)} \sum_{i=1}^k \frac{R_{i.}^2}{n_i}-3(n+1)\]</span></p>
<p>où <span class="math inline">\(n=\sum_{i=1}^k n_i\)</span> est le nombre total d’observation et <span class="math inline">\(R_{i.}\)</span> est la somme des rangs de l’échantillon <span class="math inline">\(i\)</span>.</p>
<p>La loi de la statistique de test est tabulée pour les petits échantillons. Pour les grands échantillons, la statistique de test suit une loi du <span class="math inline">\(\chi^2\)</span> à$ k − 1$ degrés de liberté́. En présence, d’ex aequo, il existe une formule ajustée.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb101-1" tabindex="-1"></a><span class="fu">kruskal.test</span>(Current<span class="sc">~</span>Biome, df)</span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  Current by Biome
## Kruskal-Wallis chi-squared = 12.314, df = 2, p-value = 0.002119</code></pre>
<p>Que pouvez vous dire par rapport aux résultats du test statistique et à la probabilité d’observer ce résultat ?</p>
</div>
<div id="test-paramétrique-anova" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Test paramétrique (<strong>ANOVA</strong>)<a href="tests-statistiques-anova-et-kruskal-wallis.html#test-paramétrique-anova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="normalisation" class="section level4 hasAnchor" number="4.1.2.1">
<h4><span class="header-section-number">4.1.2.1</span> Normalisation<a href="tests-statistiques-anova-et-kruskal-wallis.html#normalisation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Nous ne pouvons pas utiliser les précédentes données pour un test statistique À MOINS DE TRANSFORMER CES DONNÉES, de les normaliser. La transformation des données permet en outre de pouvoir utiliser des tests statistiques paramétriques (qui possèdent une puissance plus importante que les tests non paramétriques).</p>
<p>Plusieurs transformations existent. Nous en verrons deux à travers ce cours. La normalisation en centrant et réduisant les données (nous verrons cela lors du prochain cours) et la normalisation par transformation des données selon une échelle logarithmique (i.e. la fonction log() dans R).</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb103-1" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">log</span>(Current)<span class="sc">~</span>Biome, df, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;tomato&quot;</span>, <span class="st">&quot;gold&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-53"></span>
<img src="Applied-statistics_files/figure-html/unnamed-chunk-53-1.png" alt="Figure 2 : Représentation du stockage actuelle (log transformé) en fonction des biomes." width="576" />
<p class="caption">
Figure 4.2: Figure 2 : Représentation du stockage actuelle (log transformé) en fonction des biomes.
</p>
</div>
<ol style="list-style-type: lower-alpha">
<li><p>Quelles sont vos remarques ?</p></li>
<li><p>Refaire le test de normalité et d’égalités des variances.</p></li>
</ol>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb104-1" tabindex="-1"></a><span class="cf">for</span>(biome <span class="cf">in</span> <span class="fu">unique</span>(df<span class="sc">$</span>Biome)){</span>
<span id="cb104-2"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb104-2" tabindex="-1"></a>  SW <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(<span class="fu">log</span>(df<span class="sc">$</span>Current[<span class="fu">which</span>(df<span class="sc">$</span>Biome<span class="sc">==</span>biome)]))</span>
<span id="cb104-3"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb104-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Le test de Shapiro.Wilk renvoie une statistique de&quot;</span>, <span class="fu">round</span>(SW<span class="sc">$</span>statistic, <span class="dv">2</span>), <span class="st">&quot;et un p value associée de&quot;</span>, SW<span class="sc">$</span>p.value, <span class="st">&quot;pour le biome suivant&quot;</span>, biome))</span>
<span id="cb104-4"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb104-4" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Le test de Shapiro.Wilk renvoie une statistique de 0.98 et un p value associée de 3.38726641706307e-06 pour le biome suivant Subtropical&quot;
## [1] &quot;Le test de Shapiro.Wilk renvoie une statistique de 0.99 et un p value associée de 0.66406346581351 pour le biome suivant Boreal&quot;
## [1] &quot;Le test de Shapiro.Wilk renvoie une statistique de 0.98 et un p value associée de 0.484560225022285 pour le biome suivant Polar&quot;</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb106-1" tabindex="-1"></a><span class="fu">bartlett.test</span>(<span class="fu">log</span>(Current)<span class="sc">~</span>Biome, df)</span></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  log(Current) by Biome
## Bartlett&#39;s K-squared = 5.7155, df = 2, p-value = 0.0574</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li>Que pouvons-nous conclure ?</li>
</ol>
<blockquote>
<p>Attention il ne faut pas uniquement regarde la probabilité d’observée cet événement (p.value), la statistique est très importante et aide à prendre des décisions.</p>
</blockquote>
</div>
<div id="anova-à-effet-fixe-1-facteur" class="section level4 hasAnchor" number="4.1.2.2">
<h4><span class="header-section-number">4.1.2.2</span> ANOVA à effet fixe (1 facteur)<a href="tests-statistiques-anova-et-kruskal-wallis.html#anova-à-effet-fixe-1-facteur" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pour comprendre l’ANOVA (ANalysis Of VAriance), il faut bien caractériser les variables du problème pour ne pas faire d’erreur dans la formule.</p>
<ol style="list-style-type: decimal">
<li><p>Le Biome est une variable considérée comme qualitative avec trois modalités bien déterminées. Nous l’appelons le facteur. Ici, le facteur ” Biome ” est à effets fixes.</p></li>
<li><p>Le stockage actuel du Carbone au niveau des sol est considérée comme quantitative car obtenus par une mesure (analyse d’image). Nous l’appelons la variable réponse.</p></li>
</ol>
<blockquote>
<p>L’analyse de la variance permet de répondre à la question : “Y a-t-il un effet biome sur les stockages de carbone au niveau des sol ?”</p>
</blockquote>
<p>L’<strong>analyse de la variance</strong> (ANOVA) est une méthode statistique qui permet d’étudier la modification de la moyenne <span class="math inline">\(\mu\)</span> d’une quantité <span class="math inline">\(Y\)</span> (variable réponse quantitative) selon l’influence éventuelle d’un ou de plusieurs facteurs d’expérience qualitatifs (ici biome) : le facteur <span class="math inline">\(X\)</span>. Le facteur X est souvent une variable qualitative présentant un nombre restreint de modalités. On note <span class="math inline">\(J\)</span> le nombre de modalités (ici <span class="math inline">\(J=3\)</span>).</p>
<p>Le modèle de l’analyse de la variance s’écrit :</p>
<p>$ Y_{i,j} = + <em>j+</em>{i,j} $ pour <span class="math inline">\(i = 1, …, I\)</span> et <span class="math inline">\(j = 1, …, J\)</span> où</p>
<p><span class="math inline">\(Y_{i,j}\)</span> est la valeur de la variable réponse <span class="math inline">\(Y\)</span> (i.e. sockage de carbon) pour l’observation <span class="math inline">\(i\)</span> dans la modalité (niveau, i.e. biome) <span class="math inline">\(j\)</span>.</p>
<p><span class="math inline">\(\mu\)</span> est l’effet moyen.</p>
<p><span class="math inline">\(\alpha_j\)</span> est l’effet différential de la modalité <span class="math inline">\(j\)</span> (i.e. d’un biome).</p>
<p><span class="math inline">\(\varepsilon_{i,j}\)</span> est le terme d’erreur aléatoire.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb108-1" tabindex="-1"></a>cnt<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb108-2"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb108-2" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">log</span>(Current)<span class="sc">~</span>Biome, df, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;tomato&quot;</span>, <span class="st">&quot;gold&quot;</span>))</span>
<span id="cb108-3"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb108-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">mean</span>(<span class="fu">log</span>(df<span class="sc">$</span>Current)), <span class="at">col=</span><span class="st">&quot;cornflowerblue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb108-4"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb108-4" tabindex="-1"></a><span class="cf">for</span>(biome <span class="cf">in</span> <span class="fu">unique</span>(df<span class="sc">$</span>Biome)){</span>
<span id="cb108-5"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb108-5" tabindex="-1"></a>  <span class="fu">points</span>(<span class="at">x=</span><span class="fu">as.numeric</span>(<span class="fu">unique</span>(df<span class="sc">$</span>Biome))[cnt],<span class="at">y=</span><span class="fu">mean</span>(<span class="fu">log</span>(df<span class="sc">$</span>Current[<span class="fu">which</span>(df<span class="sc">$</span>Biome<span class="sc">==</span>biome)])), <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb108-6"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb108-6" tabindex="-1"></a>  cnt<span class="ot">=</span>cnt<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb108-7"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb108-7" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-56"></span>
<img src="Applied-statistics_files/figure-html/unnamed-chunk-56-1.png" alt="Figure 3 : Représentation graphique du modèle de l'Analyse des Variances. La ligne en blue correspond à la moyenne globale du modèle. Les points rouges correspondent à la somme de la moyenne globale + l'effet différentiel (moyenne des groupes)." width="480" />
<p class="caption">
Figure 4.3: Figure 3 : Représentation graphique du modèle de l’Analyse des Variances. La ligne en blue correspond à la moyenne globale du modèle. Les points rouges correspondent à la somme de la moyenne globale + l’effet différentiel (moyenne des groupes).
</p>
</div>
<p><strong>Estimation des paramètres du modèle</strong></p>
<p>L’estimation des paramètres sur R se réalise grâce à la fonction lm(). La première qui consistait à savoir quelle variable était Y et laquelle était X est très importante puisqu’elle permet de bien écrire le modèle. Ce que nous tenter de modéliser, c’est bien le stockage de carbone actuel en fonction de la variable fixe : biome. Dans R, le mot “en fonction” s’écrit <strong>~</strong>. Ainsi la formule dans R sera :</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb109-1" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(<span class="fu">log</span>(Current)<span class="sc">~</span>Biome, <span class="at">data=</span>df))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(Current) ~ Biome, data = df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.1024  -2.3482   0.2012   2.6407  10.3311 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       15.9508     0.3064  52.061   &lt;2e-16 ***
## BiomePolar         1.0181     0.6312   1.613   0.1072    
## BiomeSubtropical  -0.8022     0.3395  -2.363   0.0184 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.702 on 829 degrees of freedom
## Multiple R-squared:  0.01691,    Adjusted R-squared:  0.01454 
## F-statistic:  7.13 on 2 and 829 DF,  p-value: 0.000851</code></pre>
<ol style="list-style-type: lower-alpha">
<li>Décortiquer les résultats du modèle. Identifier la moyenne de la variable en fonction des groupes ?</li>
</ol>
<p>L’intercept dans ce modèle est le biome “Boreal”. Mais non pouvons écrire un modèle sans intercept.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb111-1" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(<span class="fu">log</span>(Current)<span class="sc">~</span><span class="dv">0</span><span class="sc">+</span>Biome, <span class="at">data=</span>df))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(Current) ~ 0 + Biome, data = df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.1024  -2.3482   0.2012   2.6407  10.3311 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## BiomeBoreal       15.9508     0.3064   52.06   &lt;2e-16 ***
## BiomePolar        16.9688     0.5519   30.75   &lt;2e-16 ***
## BiomeSubtropical  15.1486     0.1462  103.60   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.702 on 829 degrees of freedom
## Multiple R-squared:  0.9455, Adjusted R-squared:  0.9453 
## F-statistic:  4796 on 3 and 829 DF,  p-value: &lt; 2.2e-16</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>Décortiquer les résultats du modèle. Identifier la moyenne de la variable en fonction des groupes ?</li>
</ol>
<p><strong>Test d’hypothèse</strong></p>
<p>L’analyse de la variance est souvent utilisée pour tester l’égalité des moyennes.</p>
<p>Hypothèses de test</p>
<p><span class="math inline">\(H_0 : \mu_1 = \mu_2 = … = \mu_J\)</span> contre <span class="math inline">\(H_1\)</span> : au moins une des moyennes est différente.</p>
<p>ou bien (de manière équivalente) :</p>
<p><span class="math inline">\(H_0 : \alpha_1 = \alpha_2 = … = \alpha_J = 0\)</span> contre <span class="math inline">\(H_1\)</span> :au moins un <span class="math inline">\(\alpha_j\)</span> est différent de zéro.</p>
<p>On pourrait dire pour notre exemple de biome :</p>
<ul>
<li><p>Les trois biomes stocke la même quantité de carbone (en moyenne).</p></li>
<li><p>Les effets différenciels des trois biomes sont nuls.</p></li>
</ul>
<p>Rejeter <span class="math inline">\(H_0\)</span> s’interprète de la manière suivante : (1) Deux niveaux différents du facteur <span class="math inline">\(X\)</span> entrainent une différence significative de la variable réponse <span class="math inline">\(Y\)</span>. (2) Le facteur <span class="math inline">\(X\)</span> a un effet significatif sur la variable réponse <span class="math inline">\(Y\)</span>.</p>
<p><strong>Statistique de l’ANOVA</strong></p>
<p>La statistique de test se base sur les différences observées entre les moyennes des échantillons (variance inter-groupe) et les différences entre les observations à l’intérieur des échantillons (variance intra-groupe). On s’intéresse au rapport entre la variance expliquée par les facteurs (ici biome) et la variance des résidus intra-groupe.</p>
<p>Dans ce cas, nous prendrons comme notation :</p>
<p><strong>SCT</strong> (Somme des Carrés Totale) traduit la variation totale de Y.</p>
<p><strong>SCE</strong> (Somme des Carrés Expliquée) traduit la variation expliquée par le modèle.</p>
<p><strong>SCR</strong> (Somme des Carrés Résiduelle) traduit la variation inexpliquée par le modèle.</p>
<p>et nous avons la relation :</p>
<p><span class="math display">\[SCT=SCE+SCR\]</span></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-1" tabindex="-1"></a>ylim<span class="ot">=</span><span class="fu">range</span>(<span class="fu">log</span>(df<span class="sc">$</span>Current))</span>
<span id="cb113-2"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-2" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>),<span class="at">nrow=</span><span class="dv">1</span>))</span>
<span id="cb113-3"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb113-4"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-4" tabindex="-1"></a>cnt<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb113-5"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-5" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">log</span>(df<span class="sc">$</span>Current), <span class="at">ylim=</span>ylim, <span class="at">main=</span><span class="st">&quot;Variance totale (SCT)&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Carbon Storage&quot;</span>)</span>
<span id="cb113-6"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-6" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">mean</span>(<span class="fu">log</span>(df<span class="sc">$</span>Current)), <span class="at">col=</span><span class="st">&quot;cornflowerblue&quot;</span>, <span class="at">lwd=</span><span class="dv">1</span>, <span class="at">lty=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb113-7"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-7" tabindex="-1"></a></span>
<span id="cb113-8"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-8" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="dv">1</span>, <span class="at">y=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">ylim=</span>ylim, <span class="at">ylab=</span><span class="st">&quot;Carbon Storage&quot;</span>, <span class="at">axes=</span>F, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">main=</span><span class="st">&quot;Variance intergroupe (SCE)&quot;</span>)</span>
<span id="cb113-9"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-9" tabindex="-1"></a><span class="cf">for</span>(biome <span class="cf">in</span> <span class="fu">unique</span>(df<span class="sc">$</span>Biome)){</span>
<span id="cb113-10"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-10" tabindex="-1"></a>  <span class="fu">points</span>(<span class="at">x=</span><span class="dv">1</span>,<span class="at">y=</span><span class="fu">mean</span>(<span class="fu">log</span>(df<span class="sc">$</span>Current[<span class="fu">which</span>(df<span class="sc">$</span>Biome<span class="sc">==</span>biome)])), <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb113-11"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-11" tabindex="-1"></a>  cnt<span class="ot">=</span>cnt<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb113-12"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-12" tabindex="-1"></a>}</span>
<span id="cb113-13"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-13" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>)</span>
<span id="cb113-14"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-14" tabindex="-1"></a><span class="fu">box</span>()</span>
<span id="cb113-15"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-15" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">mean</span>(<span class="fu">log</span>(df<span class="sc">$</span>Current)), <span class="at">col=</span><span class="st">&quot;cornflowerblue&quot;</span>, <span class="at">lwd=</span><span class="dv">1</span>, <span class="at">lty=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb113-16"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-16" tabindex="-1"></a></span>
<span id="cb113-17"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-17" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="fu">as.numeric</span>(df<span class="sc">$</span>Biome), <span class="at">y=</span><span class="fu">log</span>(df<span class="sc">$</span>Current), <span class="at">ylim=</span>ylim, <span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">3.5</span>),</span>
<span id="cb113-18"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-18" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Carbon Storage&quot;</span>, <span class="at">axes=</span>F, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">main=</span><span class="st">&quot;Variance intragroupe (SCR)&quot;</span>)</span>
<span id="cb113-19"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-19" tabindex="-1"></a></span>
<span id="cb113-20"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-20" tabindex="-1"></a>cnt<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb113-21"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-21" tabindex="-1"></a><span class="cf">for</span>(biome <span class="cf">in</span> <span class="fu">unique</span>(df<span class="sc">$</span>Biome)){</span>
<span id="cb113-22"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-22" tabindex="-1"></a>  <span class="fu">segments</span>(<span class="at">x0=</span><span class="fu">as.numeric</span>(<span class="fu">unique</span>(df<span class="sc">$</span>Biome))[cnt]<span class="sc">+</span><span class="fl">0.1</span>,</span>
<span id="cb113-23"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-23" tabindex="-1"></a>         <span class="at">y0=</span><span class="fu">mean</span>(<span class="fu">log</span>(df<span class="sc">$</span>Current[<span class="fu">which</span>(df<span class="sc">$</span>Biome<span class="sc">==</span>biome)]))<span class="sc">-</span><span class="fu">sd</span>(<span class="fu">log</span>(df<span class="sc">$</span>Current[<span class="fu">which</span>(df<span class="sc">$</span>Biome<span class="sc">==</span>biome)])),</span>
<span id="cb113-24"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-24" tabindex="-1"></a>         <span class="at">y1=</span><span class="fu">mean</span>(<span class="fu">log</span>(df<span class="sc">$</span>Current[<span class="fu">which</span>(df<span class="sc">$</span>Biome<span class="sc">==</span>biome)]))<span class="sc">+</span><span class="fu">sd</span>(<span class="fu">log</span>(df<span class="sc">$</span>Current[<span class="fu">which</span>(df<span class="sc">$</span>Biome<span class="sc">==</span>biome)])), </span>
<span id="cb113-25"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-25" tabindex="-1"></a>         <span class="at">col=</span><span class="st">&quot;green3&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb113-26"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-26" tabindex="-1"></a>  cnt<span class="ot">=</span>cnt<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb113-27"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-27" tabindex="-1"></a>}</span>
<span id="cb113-28"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-28" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>)</span>
<span id="cb113-29"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-29" tabindex="-1"></a><span class="fu">box</span>()</span>
<span id="cb113-30"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb113-30" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">mean</span>(<span class="fu">log</span>(df<span class="sc">$</span>Current)), <span class="at">col=</span><span class="st">&quot;cornflowerblue&quot;</span>, <span class="at">lwd=</span><span class="dv">1</span>, <span class="at">lty=</span><span class="st">&quot;dashed&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-59"></span>
<img src="Applied-statistics_files/figure-html/unnamed-chunk-59-1.png" alt="Figure 4 : Représentation graphique du modèle de l'Analyse des Variances avec la variance totale, la variance intergroupe et la variance intragroupe. La ligne en blue correspond à la moyenne globale du modèle. Les points rouges correspondent à la somme de la moyenne globale + l'effet différentiel (moyenne des groupes). Les lignes vertes correspondent à la variance intragroupe." width="960" />
<p class="caption">
Figure 4.4: Figure 4 : Représentation graphique du modèle de l’Analyse des Variances avec la variance totale, la variance intergroupe et la variance intragroupe. La ligne en blue correspond à la moyenne globale du modèle. Les points rouges correspondent à la somme de la moyenne globale + l’effet différentiel (moyenne des groupes). Les lignes vertes correspondent à la variance intragroupe.
</p>
</div>
<p>On utilise la statistique de test</p>
<p><span class="math display">\[F_n = \frac{SCE/(J − 1)}{SCR/(n − J)}\]</span></p>
<p>SCE/(J − 1) est la part de variance de <span class="math inline">\(Y\)</span> expliquée par le modèle (i.e. par les modalités/facteurs <span class="math inline">\(X\)</span>),</p>
<p>SCR/(n − J) est la part résiduelle de variance <span class="math inline">\(Y\)</span>.</p>
<p>Plus <span class="math inline">\(F_n\)</span> est grande et plus on s’écarte de l’hypothèse nulle. Autrement plus la distance entre les points rouge augmente ET/OU la variance résiduelle (intragroupe) diminue, plus grande sera la statistique F.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb114-1" tabindex="-1"></a><span class="co"># ANOVA</span></span>
<span id="cb114-2"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb114-2" tabindex="-1"></a>model_estimation <span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="fu">log</span>(Current)<span class="sc">~</span>Biome, <span class="at">data=</span>df)</span>
<span id="cb114-3"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb114-3" tabindex="-1"></a><span class="fu">anova</span>(model_estimation)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: log(Current)
##            Df  Sum Sq Mean Sq F value   Pr(&gt;F)    
## Biome       2   195.4  97.714  7.1297 0.000851 ***
## Residuals 829 11361.7  13.705                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>La p value du test est très petite devant 5% d’erreur, nous pouvons dire qu’il existe un effet significatif de la modalité (biome) sur la variable réponse <span class="math inline">\(Y\)</span> (stockage de carbone).</p>
</div>
<div id="anova-à-effet-fixe-2-facteurs" class="section level4 hasAnchor" number="4.1.2.3">
<h4><span class="header-section-number">4.1.2.3</span> ANOVA à effet fixe (2 facteurs)<a href="tests-statistiques-anova-et-kruskal-wallis.html#anova-à-effet-fixe-2-facteurs" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>EN TP.</p>
<hr />
</div>
</div>
</div>
<div id="tests-statistiques-multiples." class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Tests statistiques Multiples.<a href="tests-statistiques-anova-et-kruskal-wallis.html#tests-statistiques-multiples." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="généralités-2" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Généralités<a href="tests-statistiques-anova-et-kruskal-wallis.html#généralités-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Si plusieurs hypothèses sont testées, la probabilité́ d’un évènement rare augmente et, par conséquent, la probabilité́ de rejeter de manière incorrecte une hypothèses nulle (c’est-à-dire commettre une erreur de type I) augmente. Dans ce cas là, l’hypothèse nulle rejetée serait un faux résultat positif.</p>
<p>La correction de Bonferroni compense cette augmentation en testant chaque hypothèse à un niveau de signification (ou de risque) de <span class="math inline">\(\alpha /k\)</span> ou <span class="math inline">\(\alpha\)</span> est le niveau global souhaité et <span class="math inline">\(k\)</span> le nombre d’hypothèses.</p>
<p>Dans l’exemple précèdent, on a 3 groupes et donc <span class="math inline">\(k = 3\)</span>. Si on fait les comparaisons multiples au risque 5%, on doit comparer chacune des p.values à 0.05/3. Le nouveau seuil de significativité serait 0.017.</p>
<p>Sinon, cela revient à multiplier les p-values par k (<span class="math inline">\(k=3\)</span> dans l’exemple) et comparer les p-value « corrigées » au seuil initialement fixé (par ex. 0.05). Aussi appelé test de Dunn.</p>
</div>
<div id="applications" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Applications<a href="tests-statistiques-anova-et-kruskal-wallis.html#applications" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dans le cas de nos Biome, nous souhaitons les comparer 2 à 2 et savoir comment ils diffèrent entre eux par rapport à leur capacité à stocker du Carbon.</p>
<p><strong>1) Correction de Bonferroni</strong></p>
<p>L’idée est de réaliser des tests wilcoxon entre deux biomes et estimer la p.value.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb116-1" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">unique</span>(df<span class="sc">$</span>Biome)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]){</span>
<span id="cb116-2"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb116-2" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="fu">unique</span>(df<span class="sc">$</span>Biome)[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]){</span>
<span id="cb116-3"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb116-3" tabindex="-1"></a>    <span class="cf">if</span>(i<span class="sc">!=</span>j){</span>
<span id="cb116-4"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb116-4" tabindex="-1"></a>      X <span class="ot">&lt;-</span> df<span class="sc">$</span>Current[<span class="fu">which</span>(df<span class="sc">$</span>Biome<span class="sc">==</span>i)]</span>
<span id="cb116-5"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb116-5" tabindex="-1"></a>      Y <span class="ot">&lt;-</span> df<span class="sc">$</span>Current[<span class="fu">which</span>(df<span class="sc">$</span>Biome<span class="sc">==</span>j)]</span>
<span id="cb116-6"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb116-6" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">paste</span>(i, <span class="st">&quot;Versus&quot;</span>, j))</span>
<span id="cb116-7"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb116-7" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">wilcox.test</span>(X, Y)<span class="sc">$</span>p.value)</span>
<span id="cb116-8"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb116-8" tabindex="-1"></a>    }</span>
<span id="cb116-9"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb116-9" tabindex="-1"></a>  }</span>
<span id="cb116-10"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb116-10" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Subtropical Versus Boreal&quot;
## [1] 0.03237358
## [1] &quot;Subtropical Versus Polar&quot;
## [1] 0.002687245
## [1] &quot;Boreal Versus Polar&quot;
## [1] 0.1226622</code></pre>
<ol style="list-style-type: lower-alpha">
<li><p>Entre quelles biomes observons nous des capacités de stockages différentes ?</p></li>
<li><p>Même question en applicant la correction de Bonnferroni ?</p></li>
</ol>
<p><strong>2) Test de Dunn</strong></p>
<p>On applique directement la correction de Dunn sur le script de notre boucle en multipliant la p.value de chaque test par le nombre de tests réalisés (ici <span class="math inline">\(k=3\)</span>).</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb118-1" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">unique</span>(df<span class="sc">$</span>Biome)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]){</span>
<span id="cb118-2"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb118-2" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="fu">unique</span>(df<span class="sc">$</span>Biome)[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]){</span>
<span id="cb118-3"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb118-3" tabindex="-1"></a>    <span class="cf">if</span>(i<span class="sc">!=</span>j){</span>
<span id="cb118-4"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb118-4" tabindex="-1"></a>      X <span class="ot">&lt;-</span> df<span class="sc">$</span>Current[<span class="fu">which</span>(df<span class="sc">$</span>Biome<span class="sc">==</span>i)]</span>
<span id="cb118-5"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb118-5" tabindex="-1"></a>      Y <span class="ot">&lt;-</span> df<span class="sc">$</span>Current[<span class="fu">which</span>(df<span class="sc">$</span>Biome<span class="sc">==</span>j)]</span>
<span id="cb118-6"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb118-6" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">paste</span>(i, <span class="st">&quot;Versus&quot;</span>, j))</span>
<span id="cb118-7"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb118-7" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">wilcox.test</span>(X, Y)<span class="sc">$</span>p.value<span class="sc">*</span><span class="fu">length</span>(<span class="fu">unique</span>(df<span class="sc">$</span>Biome)))</span>
<span id="cb118-8"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb118-8" tabindex="-1"></a>    }</span>
<span id="cb118-9"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb118-9" tabindex="-1"></a>  }</span>
<span id="cb118-10"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb118-10" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Subtropical Versus Boreal&quot;
## [1] 0.09712074
## [1] &quot;Subtropical Versus Polar&quot;
## [1] 0.008061734
## [1] &quot;Boreal Versus Polar&quot;
## [1] 0.3679865</code></pre>
<ol style="list-style-type: lower-alpha">
<li>Entre quelles biomes observons nous des capacités de stockages différentes ?</li>
</ol>
</div>
</div>
<div id="révisions-2" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Révisions<a href="tests-statistiques-anova-et-kruskal-wallis.html#révisions-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="qcm-2" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> QCM<a href="tests-statistiques-anova-et-kruskal-wallis.html#qcm-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>1. L’ANOVA se réalise lorsqu’il y a une variable quantitative et uniquement une variable qualitative.</strong><br />
- [ ] Vrai<br />
- [ ] Faux</p>
<details>
<summary>
Afficher la réponse
</summary>
❌ Faux
</details>
<hr />
<p><strong>2. Quelles phrases sont correctes ?</strong><br />
- [ ] On accepte H0 lorsque la p value est inférieure à 0.05<br />
- [ ] On rejette H1 lorsque la p value est inférieure à 0.05<br />
- [ ] Le seuil de significativité est modifié lorsque vous utilisez la correction de Dunn sur des tests multiples<br />
- [ ] Le Kruskal-Wallis est un test non paramétrique</p>
<details>
<summary>
Afficher la réponse
</summary>
<p>✅ On rejette H0 lorsque la p value est inférieure à 0.05.</p>
<p>✅ Le seuil de significativité est modifié avec la correction de Dunn.</p>
✅ Le Kruskal-Wallis est un test non paramétrique.
</details>
<hr />
<p><strong>3. L’ANOVA à 2 facteurs se réalise lorsque le problème inclut 2 variables quantitatives et 1 variable qualitative.</strong><br />
- [ ] Vrai<br />
- [ ] Faux</p>
<details>
<summary>
Afficher la réponse
</summary>
❌ Faux (L’ANOVA à 2 facteurs se réalise avec <strong>2 variables qualitatives</strong> et <strong>1 variable quantitative</strong>)
</details>
<hr />
<p><strong>4. Combien d’<span class="math inline">\(H_0\)</span> l’ANOVA à 2 facteurs peut-elle tester ?</strong><br />
- [ ] 1<br />
- [ ] 2<br />
- [ ] 3<br />
- [ ] 4</p>
<details>
<summary>
Afficher la réponse
</summary>
✅ 3
</details>
<hr />
</div>
<div id="questions-ouvertes-définitions-2" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Questions ouvertes (définitions)<a href="tests-statistiques-anova-et-kruskal-wallis.html#questions-ouvertes-définitions-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<strong>Définissez H0 (Hypothèse Nulle) lorsque vous réalisez un test du Shapiro-Wilk.</strong><br />

<details>
<summary>
Afficher la réponse
</summary>
H0 : La variable étudiée suit une loi normale.
</details>
<hr />
<strong>Quelle est la différence entre variable qualitative et modalité ?</strong><br />

<details>
<summary>
Afficher la réponse
</summary>
<ul>
<li><p>La <strong>variable qualitative</strong> est une variable catégorielle qui décrit une qualité/attribut.</p></li>
<li><p>Une <strong>modalité</strong> est l’une des catégories que peut prendre cette variable.<br />
Exemple : Variable = « couleur », modalités = rouge, bleu, vert.<br />
</p></li>
</ul>
</details>
<hr />
<strong>Expliquez de manière vulgarisée, en vous appuyant sur la formule de l’ANOVA à 1 facteur, comment elle fonctionne.</strong><br />

<details>
<summary>
Afficher la réponse
</summary>
<ul>
<li><p>Le <strong>numérateur</strong> de la statistique de test correspond à la variabilité <strong>entre les moyennes des groupes</strong>.</p></li>
<li><p>Le <strong>dénominateur</strong> correspond à la variabilité <strong>intra-groupe</strong> (résiduelle).</p></li>
<li><p>La statistique augmente si :</p>
<ol style="list-style-type: decimal">
<li>Les moyennes des groupes sont très différentes.<br />
</li>
<li>Les dispersion intra-groupes est faible (faible écart-type).<br />
</li>
</ol></li>
</ul>
</details>
<hr />
</div>
<div id="problème-1" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Problème<a href="tests-statistiques-anova-et-kruskal-wallis.html#problème-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Les auteurs d’une publication (<em>Am J Cancer Res 2017;7(5):1037-1053</em>) testent deux variables qualitatives avec deux modalités chacune :</p>
<ul>
<li><strong>Santé</strong> : CTL (contrôle) vs LS (cancéreux)<br />
</li>
<li><strong>Environnement</strong> : Inactive vs Active</li>
</ul>
<p>Ils mesurent la <strong>masse du tissu adipeux viscéral</strong> (moyenne ± SEM).
Les résultats sont disponibles sur cette figure :</p>
<div class="float">
<img src="figures/C.png" alt="Figure from Am J Cancer Res (2017)" />
<div class="figcaption">Figure from Am J Cancer Res (2017)</div>
</div>
<hr />
<strong>Décrire le graphique.</strong><br />

<details>
<summary>
Afficher la réponse
</summary>
Le graphique compare la masse adipeuse des souris selon une condition de santé (contrôle ou cancéreuse) et selon l’activité (active ou inactive). Visuellement, il semblerait qu’il y ait des différences entre les groupes.
</details>
<hr />
<strong>À partir du graphique, quels tests préconisez-vous ?</strong><br />

<details>
<summary>
Afficher la réponse
</summary>
Une <strong>ANOVA à 2 facteurs</strong> (santé × environnement).
</details>
<hr />
<strong>Donner les <span class="math inline">\(H_0\)</span> associées à ce graphique (questions biologiques).</strong><br />

<details>
<summary>
Afficher la réponse
</summary>
<p><strong><span class="math inline">\(H_0\)</span> (1)</strong> La masse du tissu adipeux est identique quelle que soit la modalité de la variable <strong>environnementale</strong> (active vs inactive).</p>
<p><strong><span class="math inline">\(H_0\)</span> (2)</strong> La masse du tissu adipeux est identique quelle que soit la modalité de la variable <strong>santé</strong> (contrôles vs cancéreuses).</p>
<strong><span class="math inline">\(H_0\)</span> (3)</strong> La masse du tissu adipeux n’est pas influencée par l’<strong>interaction</strong> entre santé et environnement.
</details>
<hr />
<strong>Au vu du graphique, quelles <span class="math inline">\(H_0\)</span> rejetteriez-vous ?</strong><br />

<details>
<summary>
Afficher la réponse
</summary>
On rejette <strong><span class="math inline">\(H_0\)</span> (2)</strong> → la masse adipeuse est différente selon la santé (contrôle vs cancéreuse).
</details>
</div>
</div>
<div id="travaux-pratiques-2" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Travaux pratiques<a href="tests-statistiques-anova-et-kruskal-wallis.html#travaux-pratiques-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Durée : 3h</p>
<p>Nous utiliserons pour l’ensemble des prochains TPs un jeu de données issu d’une étude réalisée dans la Station Spatial Internationale. L’ensemble des résultats est déjà publiées dans cet article : <a href="https://link.springer.com/article/10.1007/s12217-018-9653-2" class="uri">https://link.springer.com/article/10.1007/s12217-018-9653-2</a>. L’ensemble des données est téléchargeable sur la plateforme de la NASA : <a href="https://osdr.nasa.gov/bio/repo/data/studies/OSD-546" class="uri">https://osdr.nasa.gov/bio/repo/data/studies/OSD-546</a>.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb120-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># Permet de supprimer les objects et fonctions enregister sur l&#39;environnement.</span></span></code></pre></div>
<p>Objectifs : explorer les conséquences de la microgravité (i.e. pas de pesanteur) sur le métabolisme du fer dans des Hematopoïetic Stem Cell en condition de différenciation cellulaire (HSC vers osteoblastes).</p>
<p>Les données du TP peuvent être téléchargées <a href="https://github.com/DJrMartin/bookdown_applied_statistics/blob/main/data/TPs/iron_metabolism_RNA_TP.csv"><strong>ici</strong></a></p>
<ol style="list-style-type: decimal">
<li>Importer les données</li>
</ol>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb121-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">file =</span> <span class="st">&quot;data/TPs/iron_metabolism_RNA_TP.csv&quot;</span>, <span class="at">sep=</span><span class="st">&quot;;&quot;</span>, <span class="at">header =</span> T)</span>
<span id="cb121-2"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb121-2" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/TPs/meta_data.rda&quot;</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Définir les 4 conditions expérimentales. Montrer la matrice de confusion</li>
</ol>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb122-1" tabindex="-1"></a><span class="fu">table</span>(meta_data[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span></code></pre></div>
<pre><code>##          Micro_env
## Macro_env osteogenic standard
##    Ground          3        3
##    Space           3        4</code></pre>
<p>Définir les conditions de ground versus Space ?</p>
<p>Définir les conditions de osteogenic versus Standard. Lire le papier pour être au clair avec les conditions.</p>
<ol start="4" style="list-style-type: decimal">
<li><p>Faire un petit récapitulatif de comment fonctionne le métabolisme du fer au niveau intra-cellulaire. Nous pourrons appuyer nos résultats sur de la littérature existante : <a href="https://faseb.onlinelibrary.wiley.com/doi/10.1096/fj.202301184R" class="uri">https://faseb.onlinelibrary.wiley.com/doi/10.1096/fj.202301184R</a></p></li>
<li><p>définir n et p.</p></li>
</ol>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb124-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(meta_data<span class="sc">$</span>ID) <span class="co"># Nombre d&#39;individus</span></span>
<span id="cb124-2"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb124-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">dim</span>(df)[<span class="dv">1</span>] <span class="co"># Nombre de variables</span></span></code></pre></div>
<div id="statistiques-descriptives-du-metabolisme-du-fer" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Statistiques descriptives du metabolisme du fer<a href="tests-statistiques-anova-et-kruskal-wallis.html#statistiques-descriptives-du-metabolisme-du-fer" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol start="6" style="list-style-type: decimal">
<li>Visualiser l’effet du macro-environnement sur chaque expression d’ARNm.</li>
</ol>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb125-1" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>p), <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow=</span>T))</span>
<span id="cb125-2"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb125-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb125-3"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb125-3" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p){<span class="fu">boxplot</span>(<span class="fu">as.numeric</span>(df[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)][, meta_data<span class="sc">$</span>ID][i,])<span class="sc">~</span><span class="fu">as.factor</span>(meta_data<span class="sc">$</span>Macro_env), <span class="at">main=</span>(df<span class="sc">$</span>SYMBOL)[i], <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;ARN expressions&quot;</span>)}</span></code></pre></div>
<p><img src="Applied-statistics_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
<ol style="list-style-type: lower-alpha">
<li>Que peut-on dire ?</li>
<li>Quelles seraient les hypothèses H_O et H_1 ?</li>
<li>Les données sont-elles normales et/ou possèdent une variance similaire entre les groupes ?</li>
</ol>
<ol start="7" style="list-style-type: decimal">
<li>Visualiser l’effet du micro-environnement sur chaque expression d’ARNm.</li>
</ol>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb126-1" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>p), <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow=</span>T))</span>
<span id="cb126-2"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb126-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb126-3"><a href="tests-statistiques-anova-et-kruskal-wallis.html#cb126-3" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p){<span class="fu">boxplot</span>(<span class="fu">as.numeric</span>(df[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)][, meta_data<span class="sc">$</span>ID][i,])<span class="sc">~</span><span class="fu">as.factor</span>(meta_data<span class="sc">$</span>Micro_env), <span class="at">main=</span>(df<span class="sc">$</span>SYMBOL)[i], <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;ARN expressions&quot;</span>)}</span></code></pre></div>
<p><img src="Applied-statistics_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
<ol style="list-style-type: lower-alpha">
<li>Que peut-on dire ?</li>
<li>Quelles seraient les hypothèses H_O et H_1 ?</li>
<li>Les données sont-elles normales et/ou possèdent une variance similaire entre les groupes ?</li>
</ol>
<ol start="8" style="list-style-type: decimal">
<li><p>Réaliser des correlations entre les variables pour vérifier le fonctionnement du métabolisme du fer.</p></li>
<li><p>Faire la même figure en ajoutant des couleurs pour les conditions.</p></li>
</ol>
</div>
<div id="tests-statistiques" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Tests Statistiques<a href="tests-statistiques-anova-et-kruskal-wallis.html#tests-statistiques" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol start="10" style="list-style-type: decimal">
<li><p>Quels tests statistiques utiliser ?</p></li>
<li><p>via une boucle for() réaliser l’ensemble des tests ?</p></li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>pour déterminer l’effet de la vit D3 sur l’expression des ARNm ?</li>
<li>pour déterminer l’effet de la microgravité sur l’expression des ARNm ?</li>
</ol>
<ol start="12" style="list-style-type: decimal">
<li><ol style="list-style-type: lower-alpha">
<li>Quelle est la probabilité de faire une erreur de type I ?</li>
<li>Appliquer une correction ? Dunn ou Bonferroni ?</li>
</ol></li>
<li>Que peut-on dire de l’effet de la VIT D3 ? Que peut-on dire de l’effet de la microgravité (espace) sur le métabolisme du fer dans les HSC/osteoblastes ?</li>
</ol>
</div>
<div id="modelisation-à-2-facteurs" class="section level3 hasAnchor" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> Modelisation à 2 facteurs<a href="tests-statistiques-anova-et-kruskal-wallis.html#modelisation-à-2-facteurs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol start="14" style="list-style-type: decimal">
<li><p>Peut-on utiliser l’AnOVa à 1 facteur ?</p></li>
<li><p>Comprendre comment fonctionne l’AnOVa à 2 facteurs ? Ainsi que l’interaction ?</p></li>
<li><p>Explorer les données en utilisant l’AnOVa à 2 facteurs ?</p></li>
<li><p>Conclure.</p></li>
</ol>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tests-statistiques-t.-test-et-t.-wilcoxon.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tests-statistiques-corrélations.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/USERNAME/REPO/edit/BRANCH/04_tests_part3.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["Applied statistics.pdf", "Applied statistics.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
