<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Test statistique (\(\chi^2\)) | Statistique appliquée aux sciences de l’environnement et du vivant</title>
  <meta name="description" content="Ce livre est à destination des étudiants qui veulent approfondir leur connaissance en statistique appliquée aux sciences du vivant." />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Test statistique (\(\chi^2\)) | Statistique appliquée aux sciences de l’environnement et du vivant" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Ce livre est à destination des étudiants qui veulent approfondir leur connaissance en statistique appliquée aux sciences du vivant." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Test statistique (\(\chi^2\)) | Statistique appliquée aux sciences de l’environnement et du vivant" />
  
  <meta name="twitter:description" content="Ce livre est à destination des étudiants qui veulent approfondir leur connaissance en statistique appliquée aux sciences du vivant." />
  

<meta name="author" content="David M. Carminati" />


<meta name="date" content="2025-08-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-au-langage-de-programmation-r.html"/>
<link rel="next" href="tests-statistiques-t.-test-et-t.-wilcoxon.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistiques appliquées aux sciences du vivant</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Statistique appliquée aux sciences de l’environnement et du vivant.</a></li>
<li class="chapter" data-level="1" data-path="introduction-au-langage-de-programmation-r.html"><a href="introduction-au-langage-de-programmation-r.html"><i class="fa fa-check"></i><b>1</b> Introduction au langage de programmation <code>R</code></a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-au-langage-de-programmation-r.html"><a href="introduction-au-langage-de-programmation-r.html#rstudio-et-ide."><i class="fa fa-check"></i><b>1.1</b> Rstudio et IDE.</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-au-langage-de-programmation-r.html"><a href="introduction-au-langage-de-programmation-r.html#les-pré-requis"><i class="fa fa-check"></i><b>1.2</b> Les pré-requis</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introduction-au-langage-de-programmation-r.html"><a href="introduction-au-langage-de-programmation-r.html#les-objects"><i class="fa fa-check"></i><b>1.2.1</b> Les objects</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction-au-langage-de-programmation-r.html"><a href="introduction-au-langage-de-programmation-r.html#les-fonctions"><i class="fa fa-check"></i><b>1.2.2</b> Les fonctions</a></li>
<li class="chapter" data-level="1.2.3" data-path="introduction-au-langage-de-programmation-r.html"><a href="introduction-au-langage-de-programmation-r.html#les-data-frames"><i class="fa fa-check"></i><b>1.2.3</b> Les data-frames</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction-au-langage-de-programmation-r.html"><a href="introduction-au-langage-de-programmation-r.html#les-boucles"><i class="fa fa-check"></i><b>1.3</b> Les boucles</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-au-langage-de-programmation-r.html"><a href="introduction-au-langage-de-programmation-r.html#les-fonctions-version-intermédiaire"><i class="fa fa-check"></i><b>1.4</b> Les fonctions (version intermédiaire)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html"><i class="fa fa-check"></i><b>2</b> Test statistique (<span class="math inline">\(\chi^2\)</span>)</a>
<ul>
<li class="chapter" data-level="2.1" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#observationexpériencecausalité-quelques-mots-de-vocabulaire"><i class="fa fa-check"></i><b>2.1</b> Observation/Expérience/causalité (quelques mots de vocabulaire)</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#échantillonspopulations"><i class="fa fa-check"></i><b>2.1.1</b> Échantillons/populations</a></li>
<li class="chapter" data-level="2.1.2" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#donnéesindividuvariables"><i class="fa fa-check"></i><b>2.1.2</b> Données/individu/variables</a></li>
<li class="chapter" data-level="2.1.3" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#méthodologie-danalyse"><i class="fa fa-check"></i><b>2.1.3</b> Méthodologie d’analyse</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#test-statistique-avec-2-variables-qualitatives."><i class="fa fa-check"></i><b>2.2</b> Test statistique avec 2 variables qualitatives.</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#statistiques-descriptives-et-visualisations"><i class="fa fa-check"></i><b>2.2.1</b> Statistiques descriptives et visualisations</a></li>
<li class="chapter" data-level="2.2.2" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#explication-des-tests-statistiques"><i class="fa fa-check"></i><b>2.2.2</b> Explication des Tests Statistiques</a></li>
<li class="chapter" data-level="2.2.3" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#test-statistique-pour-variables-qualitatives-chi2"><i class="fa fa-check"></i><b>2.2.3</b> Test Statistique pour variables qualitatives (<span class="math inline">\(\chi^2\)</span>)</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#révision-test-du-χ²"><i class="fa fa-check"></i><b>2.3</b> Révision test du χ²</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#qcm"><i class="fa fa-check"></i><b>2.3.1</b> QCM</a></li>
<li class="chapter" data-level="2.3.2" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#questions-ouvertes-définitions"><i class="fa fa-check"></i><b>2.3.2</b> Questions ouvertes (définitions)</a></li>
<li class="chapter" data-level="2.3.3" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#problème"><i class="fa fa-check"></i><b>2.3.3</b> Problème</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#travaux-pratiques"><i class="fa fa-check"></i><b>2.4</b> Travaux Pratiques</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#pokemons"><i class="fa fa-check"></i><b>2.4.1</b> Pokemons</a></li>
<li class="chapter" data-level="2.4.2" data-path="test-statistique-chi2.html"><a href="test-statistique-chi2.html#travaux-pratiques-1"><i class="fa fa-check"></i><b>2.4.2</b> Travaux Pratiques</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tests-statistiques-t.-test-et-t.-wilcoxon.html"><a href="tests-statistiques-t.-test-et-t.-wilcoxon.html"><i class="fa fa-check"></i><b>3</b> Tests statistiques (t. test et t. wilcoxon)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tests-statistiques-t.-test-et-t.-wilcoxon.html"><a href="tests-statistiques-t.-test-et-t.-wilcoxon.html#statistiques-descriptives-et-visualisations-1"><i class="fa fa-check"></i><b>3.1</b> Statistiques descriptives et visualisations</a></li>
<li class="chapter" data-level="3.2" data-path="tests-statistiques-t.-test-et-t.-wilcoxon.html"><a href="tests-statistiques-t.-test-et-t.-wilcoxon.html#test-statistique-pour-variables-quantitatives-paramétriques-non-paramétriques"><i class="fa fa-check"></i><b>3.2</b> Test Statistique pour variables quantitatives (Paramétriques / Non paramétriques)</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="tests-statistiques-t.-test-et-t.-wilcoxon.html"><a href="tests-statistiques-t.-test-et-t.-wilcoxon.html#généralités-1"><i class="fa fa-check"></i><b>3.2.1</b> Généralités</a></li>
<li class="chapter" data-level="3.2.2" data-path="tests-statistiques-t.-test-et-t.-wilcoxon.html"><a href="tests-statistiques-t.-test-et-t.-wilcoxon.html#prérequis-pour-le-choix-du-test"><i class="fa fa-check"></i><b>3.2.2</b> Prérequis pour le choix du test</a></li>
<li class="chapter" data-level="3.2.3" data-path="tests-statistiques-t.-test-et-t.-wilcoxon.html"><a href="tests-statistiques-t.-test-et-t.-wilcoxon.html#test-paramétrique-test-de-student"><i class="fa fa-check"></i><b>3.2.3</b> Test paramétrique (test de Student)</a></li>
<li class="chapter" data-level="3.2.4" data-path="tests-statistiques-t.-test-et-t.-wilcoxon.html"><a href="tests-statistiques-t.-test-et-t.-wilcoxon.html#test-non-paramétrique-test-de-wilcoxon-mann-whitney"><i class="fa fa-check"></i><b>3.2.4</b> Test non paramétrique (test de Wilcoxon-Mann-Whitney)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="tests-statistiques-t.-test-et-t.-wilcoxon.html"><a href="tests-statistiques-t.-test-et-t.-wilcoxon.html#révisions-des-tests"><i class="fa fa-check"></i><b>3.3</b> Révisions des tests</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="tests-statistiques-t.-test-et-t.-wilcoxon.html"><a href="tests-statistiques-t.-test-et-t.-wilcoxon.html#rappel"><i class="fa fa-check"></i><b>3.3.1</b> Rappel</a></li>
<li class="chapter" data-level="3.3.2" data-path="tests-statistiques-t.-test-et-t.-wilcoxon.html"><a href="tests-statistiques-t.-test-et-t.-wilcoxon.html#qcm-1"><i class="fa fa-check"></i><b>3.3.2</b> QCM</a></li>
<li class="chapter" data-level="3.3.3" data-path="tests-statistiques-t.-test-et-t.-wilcoxon.html"><a href="tests-statistiques-t.-test-et-t.-wilcoxon.html#questions-ouvertes-définitions-1"><i class="fa fa-check"></i><b>3.3.3</b> Questions ouvertes (définitions)</a></li>
<li class="chapter" data-level="3.3.4" data-path="tests-statistiques-t.-test-et-t.-wilcoxon.html"><a href="tests-statistiques-t.-test-et-t.-wilcoxon.html#exercices-1"><i class="fa fa-check"></i><b>3.3.4</b> Exercices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html"><i class="fa fa-check"></i><b>4</b> Tests statistiques (ANOVA et Kruskal Wallis)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#tests-statistiques-pour-plusieurs-groupes"><i class="fa fa-check"></i><b>4.1</b> Tests statistiques pour plusieurs groupes</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#test-non-paramétrique-kruskall-wallis"><i class="fa fa-check"></i><b>4.1.1</b> Test non paramétrique (<strong>Kruskall-Wallis</strong>)</a></li>
<li class="chapter" data-level="4.1.2" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#test-paramétrique-anova"><i class="fa fa-check"></i><b>4.1.2</b> Test paramétrique (<strong>ANOVA</strong>)</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#tests-statistiques-multiples."><i class="fa fa-check"></i><b>4.2</b> Tests statistiques Multiples.</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#généralités-2"><i class="fa fa-check"></i><b>4.2.1</b> Généralités</a></li>
<li class="chapter" data-level="4.2.2" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#applications"><i class="fa fa-check"></i><b>4.2.2</b> Applications</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#révisions-des-tests-1"><i class="fa fa-check"></i><b>4.3</b> Révisions des tests</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#qcm-2"><i class="fa fa-check"></i><b>4.3.1</b> QCM</a></li>
<li class="chapter" data-level="4.3.2" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#questions-ouvertes-définitions-2"><i class="fa fa-check"></i><b>4.3.2</b> Questions ouvertes (définitions)</a></li>
<li class="chapter" data-level="4.3.3" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#problème-1"><i class="fa fa-check"></i><b>4.3.3</b> Problème</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#travaux-pratiques-2"><i class="fa fa-check"></i><b>4.4</b> Travaux pratiques</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#statistiques-descriptives-du-metabolisme-du-fer"><i class="fa fa-check"></i><b>4.4.1</b> Statistiques descriptives du metabolisme du fer</a></li>
<li class="chapter" data-level="4.4.2" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#tests-statistiques"><i class="fa fa-check"></i><b>4.4.2</b> Tests Statistiques</a></li>
<li class="chapter" data-level="4.4.3" data-path="tests-statistiques-anova-et-kruskal-wallis.html"><a href="tests-statistiques-anova-et-kruskal-wallis.html#modelisation-à-2-facteurs"><i class="fa fa-check"></i><b>4.4.3</b> Modelisation à 2 facteurs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="tests-statistiques-corrélations.html"><a href="tests-statistiques-corrélations.html"><i class="fa fa-check"></i><b>5</b> Tests statistiques (Corrélations)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="tests-statistiques-corrélations.html"><a href="tests-statistiques-corrélations.html#tests-dindépendance-entre-2-variables-quantitatives."><i class="fa fa-check"></i><b>5.1</b> Tests d’indépendance entre 2 variables <strong>quantitatives</strong>.</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="tests-statistiques-corrélations.html"><a href="tests-statistiques-corrélations.html#généralités-3"><i class="fa fa-check"></i><b>5.1.1</b> Généralités</a></li>
<li class="chapter" data-level="5.1.2" data-path="tests-statistiques-corrélations.html"><a href="tests-statistiques-corrélations.html#conditions"><i class="fa fa-check"></i><b>5.1.2</b> Conditions</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="tests-statistiques-corrélations.html"><a href="tests-statistiques-corrélations.html#paramètres-des-tests-de-correlation-exemple-avec-la-méthode-de-pearson"><i class="fa fa-check"></i><b>5.2</b> Paramètres des tests de correlation : Exemple avec la méthode de Pearson</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="tests-statistiques-corrélations.html"><a href="tests-statistiques-corrélations.html#premier-paramètre-a-coefficient-linéaire"><i class="fa fa-check"></i><b>5.2.1</b> Premier paramètre : <span class="math inline">\(a\)</span>, coefficient linéaire</a></li>
<li class="chapter" data-level="5.2.2" data-path="tests-statistiques-corrélations.html"><a href="tests-statistiques-corrélations.html#second-paramètre-r"><i class="fa fa-check"></i><b>5.2.2</b> Second paramètre : <span class="math inline">\(r\)</span></a></li>
<li class="chapter" data-level="5.2.3" data-path="tests-statistiques-corrélations.html"><a href="tests-statistiques-corrélations.html#troisième-paramètre-r2"><i class="fa fa-check"></i><b>5.2.3</b> troisième paramètre : <span class="math inline">\(r^2\)</span></a></li>
<li class="chapter" data-level="5.2.4" data-path="tests-statistiques-corrélations.html"><a href="tests-statistiques-corrélations.html#quatrième-paramètre-p-value"><i class="fa fa-check"></i><b>5.2.4</b> quatrième paramètre : <span class="math inline">\(p value\)</span></a></li>
<li class="chapter" data-level="5.2.5" data-path="tests-statistiques-corrélations.html"><a href="tests-statistiques-corrélations.html#code-r"><i class="fa fa-check"></i><b>5.2.5</b> Code R</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="tests-statistiques-corrélations.html"><a href="tests-statistiques-corrélations.html#test-de-spearman"><i class="fa fa-check"></i><b>5.3</b> Test de Spearman</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>6</b> Clustering</a>
<ul>
<li class="chapter" data-level="6.1" data-path="clustering.html"><a href="clustering.html#généralités-4"><i class="fa fa-check"></i><b>6.1</b> Généralités</a></li>
<li class="chapter" data-level="6.2" data-path="clustering.html"><a href="clustering.html#k-means-ou-algorithme-des-centres-mobiles-en-français"><i class="fa fa-check"></i><b>6.2</b> K-means (ou algorithme des centres mobiles en français)</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="clustering.html"><a href="clustering.html#principe"><i class="fa fa-check"></i><b>6.2.1</b> Principe</a></li>
<li class="chapter" data-level="6.2.2" data-path="clustering.html"><a href="clustering.html#algorithme-du-k-means-appartenance-à-une-classe-pour-chaque-individu"><i class="fa fa-check"></i><b>6.2.2</b> Algorithme du k-means (appartenance à une classe pour chaque individu)</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="clustering.html"><a href="clustering.html#classification-hiérarchique-ascendante"><i class="fa fa-check"></i><b>6.3</b> Classification Hiérarchique Ascendante</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="clustering.html"><a href="clustering.html#mesure-déloignement-entre-les-individus"><i class="fa fa-check"></i><b>6.3.1</b> Mesure d’éloignement entre les individus</a></li>
<li class="chapter" data-level="6.3.2" data-path="clustering.html"><a href="clustering.html#mesure-dagrégation"><i class="fa fa-check"></i><b>6.3.2</b> Mesure d’agrégation</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="clustering.html"><a href="clustering.html#définir-le-nombre-de-classes-optimales"><i class="fa fa-check"></i><b>6.4</b> Définir le nombre de classes optimales ?</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="clustering.html"><a href="clustering.html#première-approche-variance-totale-et-règle-du-coude"><i class="fa fa-check"></i><b>6.4.1</b> Première approche : Variance totale et règle du coude</a></li>
<li class="chapter" data-level="6.4.2" data-path="clustering.html"><a href="clustering.html#seconde-approche-coefficient-de-silhouette."><i class="fa fa-check"></i><b>6.4.2</b> Seconde approche : coefficient de Silhouette.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html"><i class="fa fa-check"></i><b>7</b> Analyse en Composantes Principales</a>
<ul>
<li class="chapter" data-level="7.1" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#généralités-5"><i class="fa fa-check"></i><b>7.1</b> Généralités</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#etude-des-variables"><i class="fa fa-check"></i><b>7.1.1</b> Etude des variables</a></li>
<li class="chapter" data-level="7.1.2" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#normalisation-des-individus-pré-requis"><i class="fa fa-check"></i><b>7.1.2</b> Normalisation des individus : pré-requis</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#réaliser-la-pca-sur-r."><i class="fa fa-check"></i><b>7.2</b> Réaliser la PCA sur R.</a></li>
<li class="chapter" data-level="7.3" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#interprétation"><i class="fa fa-check"></i><b>7.3</b> Interprétation</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#graphique-des-individus"><i class="fa fa-check"></i><b>7.3.1</b> Graphique des individus</a></li>
<li class="chapter" data-level="7.3.2" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#graphique-des-variables-cercle-de-correlation-des-variables"><i class="fa fa-check"></i><b>7.3.2</b> Graphique des variables (cercle de correlation des variables)</a></li>
<li class="chapter" data-level="7.3.3" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#compréhension-des-axes"><i class="fa fa-check"></i><b>7.3.3</b> Compréhension des axes</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistique appliquée aux sciences de l’environnement et du vivant</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="test-statistique-chi2" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Test statistique (<span class="math inline">\(\chi^2\)</span>)<a href="test-statistique-chi2.html#test-statistique-chi2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>Pourquoi faire des tests statistiques ?</strong></p>
<p>Faire des tests statistiques permet de donner un cadre objectif à l’interprétation des résultats expérimentaux. En effet, lorsqu’on observe une différence entre deux groupes ou une corrélation entre deux variables, il peut être difficile de savoir si cette observation reflète un phénomène réel ou simplement le fruit du hasard.</p>
<p>Le test statistique répond à cette question en quantifiant la probabilité d’obtenir un tel résultat si aucune relation véritable n’existait. Autrement dit, il permet d’<strong>évaluer si l’événement observé est rare — et donc digne d’attention car peu compatible avec l’hypothèse de hasard — ou au contraire commun, et alors probablement sans signification particulière</strong>.</p>
<blockquote>
<p>Ainsi, les tests statistiques offrent un outil essentiel pour distinguer les signaux réels des fluctuations aléatoires, et donc pour fonder les conclusions scientifiques sur une base rigoureuse.</p>
</blockquote>
<div id="observationexpériencecausalité-quelques-mots-de-vocabulaire" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Observation/Expérience/causalité (quelques mots de vocabulaire)<a href="test-statistique-chi2.html#observationexpériencecausalité-quelques-mots-de-vocabulaire" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="échantillonspopulations" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Échantillons/populations<a href="test-statistique-chi2.html#échantillonspopulations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Une population comprend tous les individus ou objets d’intérêt. Les données sont collectées à partir d’un échantillon, qui est un sous-ensemble de la population.</p>
<p><em>Exemple : pour estimer quel est le risque d’effet secondaire dans le traitement du cancer de la prostate par radio-thérapie, des chercheurs ont mené une étude sur une cohorte de plus de 300 patients. Pendant 5 ans après le traitement, ils ont surveillé la survenue d’effets secondaires. Ils ont trouvé que 35% de ces personnes ont souffert d’effets secondaires.</em></p>
<p>Quelle est l’échantillon dans cette étude ?</p>
<p>Qu’est-ce qu’une population raisonnable à laquelle nous pourrions généraliser les conclusions de l’étude ?
Ceci est indispensable à garder à l’esprit. En effet, les études sont menées sur des échantillons QUI DOIVENT ÊTRE REPRÉSENTATIF DE LA POPULATION. Dans ce context, il est possible d’inférer les résultats.</p>
<p>L’<strong>inférence statistique</strong> est le processus d’utilisation des données d’un échantillon pour obtenir des informations sur la population. <em>Exemple : “On infère sa moyenne.”</em></p>
<blockquote>
<p>Attention : le choix de l’échantillon peut-être biaisé et les conclusions de l’étude ne pourraient être généralisées à l’ensemble de la population.</p>
</blockquote>
<p>Par rapport au graphique ci-contre, prenez le temps de vous informer sur les processus d’échantillonage possibles, leur point fort et leur point faible.</p>
<div class="float">
<img src="figures/B.png" alt="Figure 1 - Schéma représentant deux processus d’échantillonage" />
<div class="figcaption">Figure 1 - Schéma représentant deux processus d’échantillonage</div>
</div>
</div>
<div id="donnéesindividuvariables" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Données/individu/variables<a href="test-statistique-chi2.html#donnéesindividuvariables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En statistique, les données issues d’un échantillon, sont rangées de telle sorte que :</p>
<ul>
<li><p>chaque ligne correspond à un(e) individu/observation.</p></li>
<li><p>chaque colonne correspond à une variable.</p></li>
</ul>
<p>Elles sont rangées dans un tableau que nous nommerons désormais une matrice <span class="math inline">\(X_{ij}\)</span> avec <span class="math inline">\(i\)</span> pour les individus/observations (lignes) et <span class="math inline">\(j\)</span> pour les variables (colonnes).</p>
</div>
<div id="méthodologie-danalyse" class="section level3 hasAnchor" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> Méthodologie d’analyse<a href="test-statistique-chi2.html#méthodologie-danalyse" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La première étape lorsque vous réalisez une analyse est de décrire les données. Quels types de données ? Quels types de variables ? Comment peut-on représenter le problème biologique de manière visuel ?</p>
<p>Pour rappel (Chapitre 1), il existe principalement deux types de variables :</p>
<ul>
<li><p>Les variables quantitatives (ex : un taux de cholesterol).</p></li>
<li><p>Les variables qualitatives (ex : des stades de cancers).</p></li>
</ul>
<p>La représentation visuelle et les statistiques associées seront totalement différentes. La visualisation dépendra du type de la variable à décrire et du problème associé.</p>
<p>Pour chacune des problématiques que nous présenterons dans ce cours, il faudra déployer cette <strong>méthodologie</strong> :</p>
<ol style="list-style-type: decimal">
<li><p>Définir la(es) variable(s) à visualiser.</p></li>
<li><p>Définir un graphique permettant de visualiser le problème.</p></li>
<li><p>Décrire numériquement les variables. Estimer des paramètres de l’échantillon ?</p></li>
<li><p>Poser les hypothèses statistiques.</p></li>
<li><p>Réaliser un test statistique pour valider ou refuser l’hypothèse nulle.</p></li>
<li><p>Conclure en restant objectif(ve) par rapport aux résultats.</p></li>
</ol>
<hr />
</div>
</div>
<div id="test-statistique-avec-2-variables-qualitatives." class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Test statistique avec 2 variables qualitatives.<a href="test-statistique-chi2.html#test-statistique-avec-2-variables-qualitatives." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="statistiques-descriptives-et-visualisations" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Statistiques descriptives et visualisations<a href="test-statistique-chi2.html#statistiques-descriptives-et-visualisations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dans le code ci joint, nous importons des données que nous stockons dans une
table de type <code>data.frame</code>, concernant des sportifs de Haut niveau (SHN) et leur type de microbiote intestinaux.</p>
<p>Dans cette étude les auteurs souhaitaient savoir si les SHN présentaient des microbiotes intestinaux différents de ceux des sujets Non-athlètes (NA).</p>
<p>Autrement dit la variable “SHN” présente si les individus (observations) sont des Sportifs de Haut Niveau (TRUE) ou non (FALSE, i.e. non athlètes). La variable “Type” prend deux valeurs soit 1 soit 2, qui définit le type de microbiote intestinal que possède l’individu. Brievement, les individus ayant un microbiote de type 1 possèdent des espèces bactériennes similaires et différents de ceux du type 2. Inversement pour les microbiote de type 2.</p>
<p>–&gt; Quelles sont les types des variables ?</p>
<p>La première étape est de transformer la matrice en table de contingence (table à double entrée) où sont répertoriées des données de comptage entre deux variables qualitatives.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="test-statistique-chi2.html#cb40-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;~/Dropbox/COURS/UBS/BIO1540/Fiches de cours/rawdata/SHN-microbiote.csv&quot;</span>, <span class="at">sep=</span><span class="st">&quot;,&quot;</span>, <span class="at">header=</span>T, <span class="at">stringsAsFactors =</span> T, <span class="at">encoding =</span> <span class="st">&#39;latin1&#39;</span>, <span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb40-2"><a href="test-statistique-chi2.html#cb40-2" tabindex="-1"></a><span class="fu">colnames</span>(df)</span></code></pre></div>
<pre><code>## [1] &quot;SHN&quot;        &quot;Enterotype&quot;</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="test-statistique-chi2.html#cb42-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">table</span>(df))</span></code></pre></div>
<pre><code>## Warning: &#39;xfun::attr()&#39; is deprecated.
## Use &#39;xfun::attr2()&#39; instead.
## See help(&quot;Deprecated&quot;)
## Warning: &#39;xfun::attr()&#39; is deprecated.
## Use &#39;xfun::attr2()&#39; instead.
## See help(&quot;Deprecated&quot;)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">1</th>
<th align="right">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">FALSE</td>
<td align="right">3</td>
<td align="right">18</td>
</tr>
<tr class="even">
<td align="left">TRUE</td>
<td align="right">18</td>
<td align="right">11</td>
</tr>
</tbody>
</table>
<p><strong>Questions</strong></p>
<ol style="list-style-type: lower-alpha">
<li><p>Pouvons-nous utiliser ces données pour déterminer si le sport influence la composition du microbiote intestinal ? Attention au verbe utilisé dans la phrase !</p></li>
<li><p>Quelle est la population d’intérêt ?</p></li>
</ol>
<blockquote>
<p>Cette question est l’une des plus importantes puisqu’elle conditionnera votre capacité à faire des conclusions à partir de votre analyse (<strong>inférence statistique</strong>). Il faut toujours se poser la question de comment a été echantillonné votre jeu de données et représente-t’il la population d’intérêt que vous souhaitez étudier. En statistique, on travaille souvent sur des échantillons. Dans ce cadre, on dira toujours qu’un paramètre (e.g. moyenne, variance, etc…) est estimé et on y ajoutera un chapeau. Ainsi, une probabilité estimée s’écrira <span class="math inline">\(\hat{p}_{j}\)</span> ou une moyenne s’écrira <span class="math inline">\(\hat{\mu}_{j}\)</span> pour une variable <span class="math inline">\(j\)</span>.</p>
</blockquote>
<ol start="3" style="list-style-type: lower-alpha">
<li><p>Quelle est la proportion de SHN dans la population (<span class="math inline">\(\hat{p}_{SHN}\)</span>) ? Proportion de SHN qui présente un microbiote de type 2 (<span class="math inline">\(\hat{p}_{SHN|M=2}\)</span>) ? Proportion de NA (Non Athlètes) qui possède un microbiote de type 2 (<span class="math inline">\(\hat{p}_{NA|M=2}\)</span>) ?</p></li>
<li><p>Trouver et interpréter <span class="math inline">\(\hat{p}_{SHN}\)</span> − <span class="math inline">\(\hat{p}_{NA}\)</span>, la différence de proportion entre SHN et NA.</p></li>
</ol>
<p>La proportion est une statistique qui aide à décrire la variable catégorielle pour ce groupe de jeunes hommes. Nous voyons que la proportion de SHN est égale à 58%. Une proportion (ou probabilité) se situera toujours entre 0 et 1 (ou bien 0 et 100%).</p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Comment peut-on représenter cette probabilité ? Utiliser la fonction pie(). <em>Vous avez toujours la possibilité d’aller de demander l’aide de R.</em></li>
</ol>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="test-statistique-chi2.html#cb44-1" tabindex="-1"></a>SHN_NA <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sum</span>(df<span class="sc">$</span>SHN<span class="sc">==</span><span class="cn">TRUE</span>),<span class="fu">sum</span>(df<span class="sc">$</span>SHN<span class="sc">==</span><span class="cn">FALSE</span>)) <span class="do">## (1) Faire la somme des SHN et NA, peu importe le type de microbiote intestinal et (2) l&#39;enregister dans un nouvel objet R.</span></span>
<span id="cb44-2"><a href="test-statistique-chi2.html#cb44-2" tabindex="-1"></a></span>
<span id="cb44-3"><a href="test-statistique-chi2.html#cb44-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)) <span class="co"># Permet de conditionner les marges du plot.</span></span>
<span id="cb44-4"><a href="test-statistique-chi2.html#cb44-4" tabindex="-1"></a><span class="fu">pie</span>(SHN_NA, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;SHN&quot;</span>, <span class="st">&quot;NA&quot;</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;firebrick&quot;</span>,<span class="st">&quot;cornflowerblue&quot;</span>)) <span class="do">## Utiliser la fonction pie.</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-16"></span>
<img src="Applied-statistics_files/figure-html/unnamed-chunk-16-1.png" alt="Figure 2 : Représentation en camembert des proportions de SHN vs NA au sein de l'échantillon étudié." width="384" />
<p class="caption">
Figure 2.1: Figure 2 : Représentation en camembert des proportions de SHN vs NA au sein de l’échantillon étudié.
</p>
</div>
<p>Le <strong>problème</strong> sous jacent est donc le suivant : Est-ce que la proportion de SHN est la même dans le groupe des microbiote de type 1 que dans le groupe des microbiote de type 2 ? Cette question porte sur la relation entre les deux variables, et non l’influence.</p>
<blockquote>
<p>ATTENTION : Assurez-vous de lire attentivement les questions lorsque vous utilisez une table à double entrée. Les questions ”Quelle proportion de SHN possède un microbiote de type 1 ? ” Et ” Quelle est la proportion de microbiote de type 1 parmi les SHN» semblent similaires mais posent des questions différentes.</p>
</blockquote>
<p>Quel graphique pour repondre à la question du problème ? Que peut-on dire ? Peut-on conclure ? Causalité ?</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="test-statistique-chi2.html#cb45-1" tabindex="-1"></a>df.proportion.Sport <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">table</span>(df), <span class="dv">2</span>, <span class="cf">function</span>(x) {x<span class="sc">/</span><span class="fu">sum</span>(x)}) <span class="co"># je calcul les proportions en ligne.</span></span>
<span id="cb45-2"><a href="test-statistique-chi2.html#cb45-2" tabindex="-1"></a>df.proportion.Microbiote <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">table</span>(df), <span class="dv">1</span>, <span class="cf">function</span>(x) {x<span class="sc">/</span><span class="fu">sum</span>(x)}) <span class="co"># je calcul les proportions en colonne.</span></span>
<span id="cb45-3"><a href="test-statistique-chi2.html#cb45-3" tabindex="-1"></a></span>
<span id="cb45-4"><a href="test-statistique-chi2.html#cb45-4" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">nrow=</span><span class="dv">1</span>)) <span class="co"># permet de réaliser une fenêtre graphique à 3 cases</span></span>
<span id="cb45-5"><a href="test-statistique-chi2.html#cb45-5" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">as.matrix</span>(df.proportion.Sport), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;firebrick&quot;</span>,<span class="st">&quot;cornflowerblue&quot;</span>), <span class="at">xlab=</span><span class="st">&quot;Type de Microbiote&quot;</span>) <span class="co"># premier plot</span></span>
<span id="cb45-6"><a href="test-statistique-chi2.html#cb45-6" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">as.matrix</span>(df.proportion.Microbiote), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>,<span class="st">&quot;green&quot;</span>), <span class="at">xlab=</span><span class="st">&quot;Sports&quot;</span>)  <span class="co"># second plot</span></span>
<span id="cb45-7"><a href="test-statistique-chi2.html#cb45-7" tabindex="-1"></a></span>
<span id="cb45-8"><a href="test-statistique-chi2.html#cb45-8" tabindex="-1"></a><span class="fu">plot.new</span>() <span class="co"># j&#39;ajoute un troisième plot vide pour pouvoir placer la légende.</span></span>
<span id="cb45-9"><a href="test-statistique-chi2.html#cb45-9" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;center&quot;</span>,<span class="fu">c</span>(<span class="st">&#39;SHN&#39;</span>, <span class="st">&#39;NA&#39;</span>, <span class="st">&quot;Type 1&quot;</span>, <span class="st">&quot;Type 2&quot;</span>), </span>
<span id="cb45-10"><a href="test-statistique-chi2.html#cb45-10" tabindex="-1"></a>       <span class="at">fill=</span><span class="fu">c</span>(<span class="st">&quot;firebrick&quot;</span>,<span class="st">&quot;cornflowerblue&quot;</span>,<span class="st">&quot;darkgreen&quot;</span>,<span class="st">&quot;green&quot;</span>), <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-17"></span>
<img src="Applied-statistics_files/figure-html/unnamed-chunk-17-1.png" alt="Figure 3 : (1) Représentation des proprotions de SHN/NA (rouge/bleue) en fonction du type de microbiote (2) Représentation des types de microbiote (vert foncé/vert clair) en fonction du niveau de sport." width="960" />
<p class="caption">
Figure 2.2: Figure 3 : (1) Représentation des proprotions de SHN/NA (rouge/bleue) en fonction du type de microbiote (2) Représentation des types de microbiote (vert foncé/vert clair) en fonction du niveau de sport.
</p>
</div>
<blockquote>
<p>Dans notre cas les deux graphiques ne sont pas différents de par la structure de notre table de contingence mais il pourrait l’être donc pensez à faire les deux graphiques/plot pour ne pas manquer les informations.</p>
</blockquote>
<blockquote>
<p>N’OUBLIEZ JAMAIS QUE RELATION NE SIGNIFIE PAS CAUSALITÉ.</p>
</blockquote>
</div>
<div id="explication-des-tests-statistiques" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Explication des Tests Statistiques<a href="test-statistique-chi2.html#explication-des-tests-statistiques" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="généralités" class="section level4 hasAnchor" number="2.2.2.1">
<h4><span class="header-section-number">2.2.2.1</span> Généralités<a href="test-statistique-chi2.html#généralités" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Un test statistique (ou test d’hypothèses) utilise des données d’un échantillon pour décider entre deux hypothèses concernant une population en contrôlant le risque de se tromper.</p>
</blockquote>
<p>Dans notre exemple où nous avons 2 variables qualitatives, nous souhaitons répondre à la question suivante : La proportion de SHN est la même dans les individus présentant un microbiote de type 1 que dans le groupe des individus présentant un microbiote de type 2.</p>
<p>Pour estimer la probabilité d’une dépendance entre deux variables qualitatives, vous pourrez utiliser le test du <span class="math inline">\(\chi^2\)</span>. Son rôle est d’estimer et comparer la répartition des fréquences des modalités observées par rapport à une répartition théorique.</p>
<p>Cette répartition théorique dépend de la question de recherche posée. La valeur de <span class="math inline">\(\chi^2\)</span> identifie la probabilité que la répartition observée diffère de la répartition théorique <strong>sous l’hypothèse nulle </strong>, en fonction du nombre de degrés de liberté (<span class="math inline">\(dl, k\)</span>).</p>
<p><strong>Hypothèse nulle <span class="math inline">\(H_0\)</span></strong>, en pratique, on commence par étudier ce qui se passe sous l’hypothèse correspondant au cas où il n’y pas de différence. On pose <span class="math inline">\(H_0\)</span> qui se lit “Hypothèse nulle” où les deux variables sont indépendantes (ici, le fait d’être sportif est indépendant du type de microbiote <strong>OU BIEN</strong> le type de microbiote intestinal est indépendant du faite d’être sportif de haut niveau).</p>
<p><strong>Hypothèse alternative <span class="math inline">\(H_1\)</span> </strong>, dans l’hypothèse alternative, on indique que les variables sont dépendantes.</p>
<p>Hypothèse nulle (<span class="math inline">\(H_0\)</span>) : Prétendre qu’il n’y a pas d’effet ou pas de dépendance.</p>
<p>Hypothèse alternative (<span class="math inline">\(H_1\)</span>) : Revendication pour laquelle nous recherchons des preuves significatives.</p>
<p>L’hypothèse alternative est établie en observant les preuves (données) qui contredisent l’hypothèse nulle et soutiennent l’alternative hypothèse.</p>
</div>
<div id="erreurs-liées-à-la-prise-de-décision-p-value" class="section level4 hasAnchor" number="2.2.2.2">
<h4><span class="header-section-number">2.2.2.2</span> Erreurs liées à la prise de décision (p value)<a href="test-statistique-chi2.html#erreurs-liées-à-la-prise-de-décision-p-value" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>On fait une erreur quand on se trompe de conclusion. Il y a 2 façons de se tromper :</p>
<ul>
<li><p>Lorsque que l’on rejette <span class="math inline">\(H_0\)</span> alors que <span class="math inline">\(H_0\)</span> vraie : Erreur de Type 1 (Faux positifs)</p></li>
<li><p>Lorsque que l’on ne refuse pas <span class="math inline">\(H_0\)</span> alors que <span class="math inline">\(H_0\)</span> fausse : Erreur de Type 2. (Faux négatifs)</p></li>
</ul>
<p>On sait estimer la probabilité de se tromper quand on rejette <span class="math inline">\(H_0\)</span> (i.e. p.value).</p>
<blockquote>
<p>A retenir, dans un test statistique, vous calculez deux paramètres : la statistique du test et la p value. Plus la p value tend vers 0 et plus le phénomène est rare sous <span class="math inline">\(H_0\)</span>. Le degré de signification (ou p-value) nous donne un moyen formel de mesurer la “force” de la preuve qu’un échantillon fournit contre l’hypothèse nulle et à l’appui de l’hypothèse alternative. Autrement dit, <strong>la p value nous informe sur le risque que l’on prend à rejetter <span class="math inline">\(H_O\)</span> à tort</strong>.</p>
</blockquote>
<p>Dans le cas du test du <span class="math inline">\(\chi^2\)</span>, par exemple, plus le phénomène est rare sous <span class="math inline">\(H_0\)</span> et plus la dépendance entre deux variables qualitatives est importante.</p>
</div>
</div>
<div id="test-statistique-pour-variables-qualitatives-chi2" class="section level3 hasAnchor" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> Test Statistique pour variables qualitatives (<span class="math inline">\(\chi^2\)</span>)<a href="test-statistique-chi2.html#test-statistique-pour-variables-qualitatives-chi2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Le test du <span class="math inline">\(\chi^2\)</span> va comparer les fréquences observées (O=observed) avec les fréquences attendues (E=expected) si H0 est correcte ou si nous choississons l’hypothèse alternative avec les taux d’erreurs associés.</p>
<p>Si nous repartons de notre tableau de contingence, nous avons observons les répartitions ci contre.</p>
<table>
<thead>
<tr class="header">
<th align="left">Sports // type</th>
<th align="center">1</th>
<th align="center">2</th>
<th align="right"><strong>Total</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NA</td>
<td align="center">3</td>
<td align="center">18</td>
<td align="right">21</td>
</tr>
<tr class="even">
<td align="left">SHN</td>
<td align="center">18</td>
<td align="center">11</td>
<td align="right">29</td>
</tr>
<tr class="odd">
<td align="left"><strong>Total</strong></td>
<td align="center">21</td>
<td align="center">29</td>
<td align="right">50</td>
</tr>
</tbody>
</table>
<p><strong>Question</strong> Quels sont les probabilités attendues (Expected) <strong>sous H0</strong>? Nous observons que notre population se compose à 58% de SHN donc si les variables était totalement indépendantes on s’attendrait à avoir 58% de SHN dans chacun des types de microbiote intestinaux. On peut prendre le problème dans l’autre sens, nous observons 42% de microbiote de type 1, on devrait retrouver ce microbiote chez 42% des SHN et chez 42% de NA.</p>
<p><strong>Réponse</strong> Etant donné que nous observons 21 microbiotes de type 1 (sur l’ensemble de notre échantillon) sur 50 individus, la probabilité <span class="math inline">\(\hat{p}_{T1}\)</span> est égale à 42% (ou 0.42), la théorie veut que 42% des SHN (0.42 x 29) et 42% des NA se trouvent dans la colonne 1 correspondant aux individus possédant un microbiote de type 1.</p>
<table>
<thead>
<tr class="header">
<th align="left">Sports // Type</th>
<th align="center">1</th>
<th align="center">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NA</td>
<td align="center">21 x 0.42 = 8.82</td>
<td align="center">21 x 0.58 = 12.18</td>
</tr>
<tr class="even">
<td align="left">SHN</td>
<td align="center">29 x 0.42 = 12.18</td>
<td align="center">29 x 0.58 = 16.82</td>
</tr>
</tbody>
</table>
<p><strong>Question</strong> Faites la même chose en faisant le raissonnement à partir du niveau de sports ?</p>
<p>Le calcul de la statistique se définit donc par l’écart entre la répartition observée et la répartition théorique soit :</p>
<p><span class="math display">\[\chi^2 = \sum_{j,k} {\frac{(O_{j,k}-E_{j,k})^2}{E_{j,k}}} \]</span></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="test-statistique-chi2.html#cb46-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">chisq.test</span>(df<span class="sc">$</span>SHN, df<span class="sc">$</span>Enterotype))</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  df$SHN and df$Enterotype
## X-squared = 9.5389, df = 1, p-value = 0.002012</code></pre>
<blockquote>
<p>Il faut retenir que le test du <span class="math inline">\(\chi^2\)</span> se base sur la différence entre ce que l’on observe et ce que l’on devrait observer sous <span class="math inline">\(H_0\)</span>.</p>
</blockquote>
<p><strong>Conclusion</strong> Que faut-il conclure ? Est-ce que la pratique du sport impacte le type de microbiote intestinal ? ou bien est-ce le type de microbiote intestinal qui permet de devenir un athlète de Haut Niveau ?</p>
</div>
</div>
<div id="révision-test-du-χ²" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Révision test du χ²<a href="test-statistique-chi2.html#révision-test-du-χ²" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="qcm" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> QCM<a href="test-statistique-chi2.html#qcm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>1. Le test du chi2 se réalise lorsque les deux variables sont :</strong><br />
- [ ] Qualitatives<br />
- [ ] Quantitatives</p>
<details>
<summary>
Afficher la réponse
</summary>
✅ Qualitatives
</details>
<hr />
<p><strong>2. H0 signifie que les variables sont dépendantes.</strong><br />
- [ ] Vrai<br />
- [ ] Faux</p>
<details>
<summary>
Afficher la réponse
</summary>
❌ Faux (H0 : les variables sont indépendantes)
</details>
<hr />
<p><strong>3. Si la statistique de test du chi2 est grande alors sa p.value sera :</strong><br />
- [ ] Faible<br />
- [ ] Élevée</p>
<details>
<summary>
Afficher la réponse
</summary>
✅ Faible
</details>
<hr />
<p><strong>4. Une variable qualitative possède toujours 2 modalités :</strong><br />
- [ ] Vrai<br />
- [ ] Faux</p>
<details>
<summary>
Afficher la réponse
</summary>
❌ Faux (elle peut avoir un grand nombre de modalités)
</details>
<hr />
<p><strong>5. Une probabilité est comprise entre -1 et 1 :</strong><br />
- [ ] Vrai<br />
- [ ] Faux</p>
<details>
<summary>
Afficher la réponse
</summary>
❌ Faux (elle possède une valeur entre 0 et 1)
</details>
<hr />
<p><strong>6. Ce test statistique se base sur quel paramètre de position :</strong><br />
- [ ] Moyenne<br />
- [ ] Médiane<br />
- [ ] Quantiles<br />
- [ ] Aucun</p>
<details>
<summary>
Afficher la réponse
</summary>
✅ Aucun
</details>
<hr />
</div>
<div id="questions-ouvertes-définitions" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Questions ouvertes (définitions)<a href="test-statistique-chi2.html#questions-ouvertes-définitions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<strong>Quel est le principe du calcul de la statistique de ce test ?</strong><br />

<details>
<summary>
Afficher la réponse
</summary>
Le principe est de comparer les probabilités observées (Observed) et les probabilités attendues (Expected) sous H0 (c’est-à-dire lorsque les variables sont totalement indépendantes).
</details>
<hr />
<strong>Donner la définition de H0 (Hypothèse Nulle) ?</strong><br />

<details>
<summary>
Afficher la réponse
</summary>
L’hypothèse nulle correspond à la situation où il n’existe aucune différence entre les conditions expérimentales ou bien que les groupes de variables étudiés soient indépendants.
</details>
<hr />
<strong>Le refus de H0 implique une prise de risque. Expliquez de manière vulgarisée.</strong><br />

<details>
<summary>
Afficher la réponse
</summary>
<p>Le refus de H0 s’effectue après avoir pris connaissance de la p value.<br />
Plus la p value tend vers 0, plus le phénomène est rare sous H0.</p>
La p value mesure le risque que l’on prend à rejeter H0 à tort.<br />
Exemple : si p = 0.04, rejeter H0 signifie que l’on prend un risque de 4 % de se tromper.
</details>
<hr />
</div>
<div id="problème" class="section level3 hasAnchor" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> Problème<a href="test-statistique-chi2.html#problème" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="énoncé" class="section level4 hasAnchor" number="2.3.3.1">
<h4><span class="header-section-number">2.3.3.1</span> Énoncé<a href="test-statistique-chi2.html#énoncé" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Vous devez évaluer un jeune médecin qui apprend à classer les individus <strong>SAINS</strong> ou <strong>MALADES</strong>.<br />
Pour ce faire, vous lui donnez des lames de microscope où se trouvent des biopsies de foie.<br />
Le médecin doit évaluer l’évolution de la stéatose hépatique (stockage de graisse).</p>
<p>Vous récupérez ses verdicts sur <strong>200 patients</strong>.<br />
Vous donnez les mêmes lames à un médecin expérimenté qui les classe à son tour.</p>
<p>Votre objectif est de savoir si les deux médecins classent de la même manière les patients.</p>
<p>La classification du médecin expérimenté sont en lignes et celle du jeune médecin en colonnes.</p>
<hr />
</div>
<div id="tableau-de-classification" class="section level4 hasAnchor" number="2.3.3.2">
<h4><span class="header-section-number">2.3.3.2</span> Tableau de classification<a href="test-statistique-chi2.html#tableau-de-classification" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<table>
<thead>
<tr class="header">
<th></th>
<th><strong>SAINS (Jeune)</strong></th>
<th><strong>MALADES (Jeune)</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>SAINS (Exp.)</strong></td>
<td>90</td>
<td>5</td>
</tr>
<tr class="even">
<td><strong>MALADES (Exp.)</strong></td>
<td>10</td>
<td>95</td>
</tr>
</tbody>
</table>
<hr />
<strong>Décrivez de manière littéraire la première case en haut à gauche.</strong><br />

<details>
<summary>
Afficher la réponse
</summary>
La case bleue nous donne le nombre de patients qui sont classés comme étant SAINS par les deux médecins.
</details>
<hr />
<strong>Quelle est la probabilité d’être classé MALADES par le médecin expérimenté lorsque le jeune médecin classe les patients comme étant MALADES ?</strong><br />

<details>
<summary>
Afficher la réponse
</summary>
95 / (10+95) = <strong>95 %</strong>
</details>
<hr />
<strong>Quelle est la probabilité d’être classé SAINS par le jeune médecin lorsque le médecin expérimenté les classe comme étant MALADES ? Que pouvez-vous dire de l’évaluation du jeune médecin ?</strong><br />

<details>
<summary>
Afficher la réponse
</summary>
5 / (5+95) = <strong>5 %</strong><br />
→ Le jeune médecin se trompe dans 5 % des cas en sous-classant des malades en sains.
</details>
<hr />
<strong>Définir H0 ? Puis définir H1 ?</strong><br />

<details>
<summary>
Afficher la réponse
</summary>
<ul>
<li>H0 : Les deux classifications effectuées par les médecins sont indépendantes (dissimilaires).<br />
</li>
<li>H1 : Les deux classifications effectuées par les médecins sont dépendantes (proches).</li>
</ul>
</details>
<hr />
<strong>Calculer les probabilités de classification du jeune médecin sous <span class="math inline">\(H_0\)</span> ?</strong><br />

<details>
<summary>
Afficher la réponse
</summary>
<ul>
<li>SAINS : 47,5 %<br />
</li>
<li>MALADES : 52,5 %</li>
</ul>
</details>
<hr />
<strong>Calculer la statistique de test du <span class="math inline">\(\chi^2\)</span> pour la case en bas à droite ?</strong><br />

<details>
<summary>
Afficher la réponse
</summary>
Statistique de test = <span class="math inline">\(\frac{\left(\tfrac{95}{100} - \tfrac{105}{200}\right)^{2}}{\tfrac{105}{200}}\)</span>
</details>
<hr />
<strong>La statistique du test définit une p value proche de 0.01. Conclure.</strong><br />

<details>
<summary>
Afficher la réponse
</summary>
On rejette H0 au seuil de 5 %, donc les deux médecins classent de manière significativement proche.
</details>
</div>
</div>
</div>
<div id="travaux-pratiques" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Travaux Pratiques<a href="test-statistique-chi2.html#travaux-pratiques" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="pokemons" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Pokemons<a href="test-statistique-chi2.html#pokemons" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Appliquer l’ensemble des analyses du chapitre sur un jeu de données concernant les Pokemons provenant de <a href="https://www.data.gouv.fr/fr/datasets/jeu-de-donnees-sur-les-pokemons/" class="uri">https://www.data.gouv.fr/fr/datasets/jeu-de-donnees-sur-les-pokemons/</a>. Je vous mets à disposition une table à double entrée où sont présentés deux variables : (1) Le pokémon possède 1 ou 2 types (Roche, Eau, Feu, Plantes, etc…) et (2) le pokémon possède une évolution (Oui ou Non).</p>
<table>
<thead>
<tr class="header">
<th align="left">Evolution // nb de type</th>
<th align="center">1 type</th>
<th align="center">2 types</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Oui</td>
<td align="center">51</td>
<td align="center">59</td>
</tr>
<tr class="even">
<td align="left">Non</td>
<td align="center">64</td>
<td align="center">41</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: lower-alpha">
<li><p>Quelles sont les variables ?</p></li>
<li><p>Poser <span class="math inline">\(H_0\)</span> et <span class="math inline">\(H_1\)</span> ?</p></li>
<li><p>Réprésenter les résultats sous forme de graphique ?</p></li>
<li><p>Définir l’erreur de type 1 ?</p></li>
<li><p>Quelle conclusion ?</p></li>
</ol>
</div>
<div id="travaux-pratiques-1" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Travaux Pratiques<a href="test-statistique-chi2.html#travaux-pratiques-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dans ce premier TP, votre objectif sera de déterminer le nombre d’heures de sports à réaliser par semaine associé avec un risque faible de développer une pathologie cardiovasculaire.</p>
<p>L’objetif sous jacent de ce TP est de se familiriser avec la simulation des données par conséquent toutes les conclusions seront scienfitiquement infondées.</p>
<p>Pour avoir accès à des résultats scientifiques fondés sur ce sujet, je vous invite à lire la review suivante : <a href="https://www.ahajournals.org/doi/full/10.1161/JAHA.115.002495">AHAJournal</a>.</p>
<p><strong>Votre objectif est donc de déterminer un seuil concernant la pratique d’AP.</strong></p>
<div id="partie-simulation" class="section level4 hasAnchor" number="2.4.2.1">
<h4><span class="header-section-number">2.4.2.1</span> Partie simulation<a href="test-statistique-chi2.html#partie-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol start="0" style="list-style-type: decimal">
<li>Définir une seed à 12 avec la fonction set.seed()</li>
</ol>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="test-statistique-chi2.html#cb48-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Définir un nombre de sujets à 200 que vous enregistrerez dans un objet n.</li>
</ol>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="test-statistique-chi2.html#cb49-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Simuler pour les n sujets un nombre d’heures de sport par semaine, grâce à une loi de poisson avec un lamdba de 4.2. Nous ajouterons un bruit gaussien.</li>
</ol>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="test-statistique-chi2.html#cb50-1" tabindex="-1"></a>PA <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, <span class="fl">4.2</span>)<span class="sc">+</span><span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li><p>Quelle type de variable ?</p></li>
<li><p>Visualiser l’hétérogénéité de la variable activité physique, i.e. PA.</p></li>
<li><p>Définir un risque de développer une pathologie cardiovasculaire. La variable Risk comprendra 2 modalités (“Pas de risque” et “risque”). Vous devrez la créer à partir d’une loi binomiale où la probabilité de ne pas développer de risque (i.e. Pas de risque = 1) sera proportionnelle au niveau d’activité physique.</p></li>
</ol>
<p>Utiliser la fonction rbinom() pour introduire une probabilité de développé une pathologie cardiaque | nb heures de sport.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="test-statistique-chi2.html#cb51-1" tabindex="-1"></a>Risk <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb51-2"><a href="test-statistique-chi2.html#cb51-2" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb51-3"><a href="test-statistique-chi2.html#cb51-3" tabindex="-1"></a>  Risk <span class="ot">&lt;-</span> <span class="fu">c</span>(Risk, <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, PA[i]<span class="sc">/</span><span class="dv">10</span><span class="sc">+</span>(<span class="fl">0.1</span>)))</span>
<span id="cb51-4"><a href="test-statistique-chi2.html#cb51-4" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Warning in rbinom(1, 1, PA[i]/10 + (0.1)): NAs produced
## Warning in rbinom(1, 1, PA[i]/10 + (0.1)): NAs produced
## Warning in rbinom(1, 1, PA[i]/10 + (0.1)): NAs produced
## Warning in rbinom(1, 1, PA[i]/10 + (0.1)): NAs produced
## Warning in rbinom(1, 1, PA[i]/10 + (0.1)): NAs produced
## Warning in rbinom(1, 1, PA[i]/10 + (0.1)): NAs produced
## Warning in rbinom(1, 1, PA[i]/10 + (0.1)): NAs produced
## Warning in rbinom(1, 1, PA[i]/10 + (0.1)): NAs produced
## Warning in rbinom(1, 1, PA[i]/10 + (0.1)): NAs produced</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="test-statistique-chi2.html#cb53-1" tabindex="-1"></a><span class="co"># Renommer la variable Risk (R) pour que le 1 soit égal à pas de risque.</span></span>
<span id="cb53-2"><a href="test-statistique-chi2.html#cb53-2" tabindex="-1"></a><span class="co"># Renommer la variable Risk (R) pour que le 0 soit égal à risque.</span></span>
<span id="cb53-3"><a href="test-statistique-chi2.html#cb53-3" tabindex="-1"></a>Risk[Risk<span class="sc">==</span><span class="dv">1</span>]<span class="ot">=</span><span class="st">&quot;Pas_de_risque&quot;</span> ; Risk[Risk<span class="sc">==</span><span class="dv">0</span>]<span class="ot">=</span><span class="st">&quot;risque&quot;</span></span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>Quelle type de variable ?</li>
</ol>
</div>
<div id="partie-test-statistique" class="section level4 hasAnchor" number="2.4.2.2">
<h4><span class="header-section-number">2.4.2.2</span> Partie test statistique<a href="test-statistique-chi2.html#partie-test-statistique" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol start="7" style="list-style-type: decimal">
<li>Visualiser les données ensemble.</li>
</ol>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="test-statistique-chi2.html#cb54-1" tabindex="-1"></a><span class="fu">boxplot</span>(PA<span class="sc">~</span>Risk)</span></code></pre></div>
<p><img src="Applied-statistics_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<ol start="8" style="list-style-type: decimal">
<li>Quelle est la probabilité d’avoir un risque de développer une pathologie cardiaque en fonction de la pratique du sport ?</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Réaliser une boucle pour nb_PA étant le nombre d’heure de sport allant de 1 à 8 heures par semaine pour déterminer la probabilité d’avoir un risque de développer une pathologie cardiaque.</li>
</ol>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="test-statistique-chi2.html#cb55-1" tabindex="-1"></a>P_risk <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb55-2"><a href="test-statistique-chi2.html#cb55-2" tabindex="-1"></a><span class="cf">for</span> (nb_PA <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>){</span>
<span id="cb55-3"><a href="test-statistique-chi2.html#cb55-3" tabindex="-1"></a>  P_risk <span class="ot">&lt;-</span> <span class="fu">c</span>(P_risk, <span class="fu">table</span>(<span class="fu">data.frame</span>(Risk, PA<span class="sc">&gt;=</span>nb_PA))[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">table</span>(<span class="fu">data.frame</span>(Risk, PA<span class="sc">&gt;=</span>nb_PA))[,<span class="dv">2</span>]))</span>
<span id="cb55-4"><a href="test-statistique-chi2.html#cb55-4" tabindex="-1"></a>}</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Réaliser un graphique de la prababilité du risque en fonction de la pratique d’activité physique.</li>
</ol>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="test-statistique-chi2.html#cb56-1" tabindex="-1"></a><span class="fu">plot</span>(P_risk<span class="sc">~</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="Applied-statistics_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<ol start="9" style="list-style-type: decimal">
<li><p>Quel seuil pourrions vous définir ?</p></li>
<li><p>Utiliser le test du CHI2 pour vous aider à prendre une décision. Définir les hypothèses du test ?
À quelle réponse serions nous capable de répondre ?</p></li>
</ol>
<p>–&gt; Est-ce que la proportion de sujet actif (seuil choisi) est la même dans le groupe “risque” que dans le groupe “pas de risque” ?</p>
<blockquote>
<p>Cette question porte sur la relation entre les deux variables.</p>
</blockquote>
<ol style="list-style-type: lower-alpha">
<li>Réaliser une boucle pour nb_PA étant le nombre d’heure de sport allant de 1 à 8 heures par semaine pour déterminer la statistique de test et la p value du test du CHI2</li>
</ol>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="test-statistique-chi2.html#cb57-1" tabindex="-1"></a>p.value <span class="ot">=</span> statistique <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb57-2"><a href="test-statistique-chi2.html#cb57-2" tabindex="-1"></a><span class="cf">for</span> (nb_PA <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>){</span>
<span id="cb57-3"><a href="test-statistique-chi2.html#cb57-3" tabindex="-1"></a>  statistique <span class="ot">&lt;-</span> <span class="fu">c</span>(statistique, <span class="fu">chisq.test</span>(<span class="fu">table</span>(<span class="fu">data.frame</span>(Risk, PA<span class="sc">&gt;=</span>nb_PA)))<span class="sc">$</span>statistic)</span>
<span id="cb57-4"><a href="test-statistique-chi2.html#cb57-4" tabindex="-1"></a>  p.value <span class="ot">&lt;-</span> <span class="fu">c</span>(p.value, <span class="fu">chisq.test</span>(<span class="fu">table</span>(<span class="fu">data.frame</span>(Risk, PA<span class="sc">&gt;=</span>nb_PA)))<span class="sc">$</span>p.value)</span>
<span id="cb57-5"><a href="test-statistique-chi2.html#cb57-5" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Warning in chisq.test(table(data.frame(Risk, PA &gt;= nb_PA))): Chi-squared
## approximation may be incorrect
## Warning in chisq.test(table(data.frame(Risk, PA &gt;= nb_PA))): Chi-squared
## approximation may be incorrect</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>Réaliser un graphique de la statistique du test en fonction de la pratique d’activité physique en colorant les points en fonction de la p.value.</li>
</ol>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="test-statistique-chi2.html#cb59-1" tabindex="-1"></a><span class="fu">plot</span>(statistique<span class="sc">~</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>), <span class="at">col=</span>p.value<span class="sc">&lt;</span><span class="fl">0.05</span>)</span></code></pre></div>
<p><img src="Applied-statistics_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Dans quelle condition les variables sont les plus dépendantes entre elles.</li>
</ol>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="test-statistique-chi2.html#cb60-1" tabindex="-1"></a><span class="fu">which.min</span>(p.value)</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li>Visualiser la table de confusion à l’aide de la fonction barplot() avec le seuil choisi en ajoutant les résultats du test statistique (statistique du test + p value).</li>
</ol>
<ol start="11" style="list-style-type: decimal">
<li>Que peut-on conclure ?</li>
</ol>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-au-langage-de-programmation-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tests-statistiques-t.-test-et-t.-wilcoxon.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/USERNAME/REPO/edit/BRANCH/02_ChiSquared.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["Applied statistics.pdf", "Applied statistics.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
